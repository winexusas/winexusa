"use strict";var appstleInit=function appstleInit(){var _RS,_RS$Config,_RS4,_RS4$Config,head=document.getElementsByTagName("head")[0],startingTime=new Date().getTime();if(typeof jQuery=="undefined"&&((_RS=RS)===null||_RS===void 0||(_RS$Config=_RS.Config)===null||_RS$Config===void 0||!_RS$Config.disableLoadingJquery)){var jQueryScript=document.createElement("script");jQueryScript.src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js",jQueryScript.type="text/javascript",head.appendChild(jQueryScript)}if(typeof Mustache=="undefined"){var mustacheScript=document.createElement("script");mustacheScript.src="https://cdnjs.cloudflare.com/ajax/libs/mustache.js/3.1.0/mustache.js",mustacheScript.type="text/javascript",head.appendChild(mustacheScript)}var checkReady=function e(n){window.jQuery&&window.Mustache&&window.Shopify?n(jQuery):window.setTimeout(function(){e(n)},20)},urlParams=new URLSearchParams(window.location.search),globalUrlParameter=urlParams.get("variant");if(checkReady(function($){(function(){var _window17,_window17$RS,_window17$RS$Config,_jQuery2,_window26,_window26$RS,_window26$RS$Config,_window27,_window27$RS,_window27$RS$Config,endingTime=new Date().getTime(),tookTime=endingTime-startingTime;function renderWidget(standAloneProduct,standAloneElement,widgetId){if(window.Shopify){var product=RSConfig.product;standAloneProduct&&(product=standAloneProduct),processProductVariants(product);var localVariantsByTitle=RSConfig.variantsByTitle,localVariantsById=RSConfig.variantsById,localWindowVariant,widgetLabels=JSON.parse(RS.Config.labels),Selling_Plan_Variants_Global={},appstleSubscriptionFunction=function(){if(urlIsProductPage()===!0||appstleStandAloneSelectorExists()){var e,n,t,i,a,l,o,r=buildAtcButtonSelector(),s=jQuery(r).first();standAloneElement&&(s=standAloneElement).addClass("appstle_stand_alone_selector_processed");var c="#appstle-subscription-widget-placeholder";s.parents((e=RSConfig)===null||e===void 0?void 0:e.widgetParentSelector).find((n=RSConfig)===null||n===void 0?void 0:n.quantitySelector).on("change, click",function(){setTimeout(updateStateOfWidget,100)}),$(document).on("click","#appstle_subscription_widget".concat(widgetId," [data-appstle-icon]"),function(){$(this).toggleClass("appstle-tooltip-show")});var p=function(){var u=null;try{s=jQuery(r).first(),standAloneElement&&(s=standAloneElement);var _=detectVariant(i,s,product);if(_){var f,y=_.id;if(i&&i===y)return;if(product.selling_plan_groups&&0<product.selling_plan_groups.length&&(f=product.selling_plan_groups.filter(function(z){return z.app_id==="appstle"})),f&&0<f.length&&RS.Config.widgetEnabled){var w,m,Q,D,M,q;localWindowVariant=_;var H,U=RS.Config.selectors.atcButtonPlacement;if(a?(unbindEventListeners(),a.children().remove(),addSubscriptionItems(a,_),u=createJsonformat(),o?a.insertBefore(o):a.appendTo(l)):(l=jQuery('<div class="appstle_sub_widget appstle-hidden" id="appstle_subscription_widget'+widgetId+'"></div>'),t=RS.Config.purchaseOptionsText?jQuery('<div class="appstle_widget_title">'+RS.Config.purchaseOptionsText+"</div>"):"",a=jQuery('<div class="appstle_subscription_wrapper"></div>'),o=RS.Config.tooltipTitle&&RS.Config.showTooltip&&!RS.Config.showStaticTooltip?jQuery('<div data-appstle-icon="" class="appstle_tooltip_wrapper">\n                        <svg width="90" height="90" viewBox="0 0 90 90" xmlns="http://www.w3.org/2000/svg" class="tooltip_subscription_svg">\n                          <path d="M45 0C20.1827 0 0 20.1827 0 45C0 69.8173 20.1827 90 45 90C69.8173 90 90 69.8174 90 45C90.0056 44.6025 89.9322 44.2078 89.7839 43.8389C89.6357 43.47 89.4156 43.1342 89.1365 42.8511C88.8573 42.568 88.5247 42.3432 88.158 42.1897C87.7912 42.0363 87.3976 41.9573 87 41.9573C86.6024 41.9573 86.2088 42.0363 85.842 42.1897C85.4753 42.3432 85.1427 42.568 84.8635 42.8511C84.5844 43.1342 84.3643 43.47 84.2161 43.8389C84.0678 44.2078 83.9944 44.6025 84 45C84 66.5748 66.5747 84 45 84C23.4253 84 6 66.5747 6 45C6 23.4254 23.4253 6 45 6C56.1538 6 66.3012 10.5882 73.4375 18H65.4062C65.0087 17.9944 64.614 18.0678 64.2451 18.2161C63.8762 18.3643 63.5405 18.5844 63.2573 18.8635C62.9742 19.1427 62.7494 19.4753 62.596 19.842C62.4425 20.2088 62.3635 20.6024 62.3635 21C62.3635 21.3976 62.4425 21.7912 62.596 22.158C62.7494 22.5247 62.9742 22.8573 63.2573 23.1365C63.5405 23.4156 63.8762 23.6357 64.2451 23.7839C64.614 23.9322 65.0087 24.0056 65.4062 24H79.8125C80.6081 23.9999 81.3711 23.6838 81.9337 23.1212C82.4963 22.5586 82.8124 21.7956 82.8125 21V6.59375C82.821 6.18925 82.7476 5.78722 82.5966 5.41183C82.4457 5.03644 82.2205 4.69545 81.9344 4.40936C81.6483 4.12327 81.3073 3.898 80.9319 3.7471C80.5565 3.5962 80.1545 3.52277 79.75 3.53125C79.356 3.53941 78.9675 3.62511 78.6067 3.78344C78.2458 3.94177 77.9197 4.16963 77.6469 4.45402C77.3741 4.73841 77.16 5.07375 77.0168 5.44089C76.8737 5.80803 76.8042 6.19977 76.8125 6.59375V12.875C68.6156 4.86282 57.3081 0 45 0ZM43.75 20.75C43.356 20.7582 42.9675 20.8439 42.6067 21.0022C42.2458 21.1605 41.9197 21.3884 41.6469 21.6728C41.3741 21.9572 41.16 22.2925 41.0168 22.6596C40.8737 23.0268 40.8042 23.4185 40.8125 23.8125V47.375C40.8116 47.7693 40.8883 48.16 41.0385 48.5246C41.1886 48.8892 41.4092 49.2207 41.6875 49.5L54.0938 61.9375C54.6573 62.5011 55.4217 62.8177 56.2188 62.8177C57.0158 62.8177 57.7802 62.5011 58.3438 61.9375C58.9073 61.3739 59.224 60.6095 59.224 59.8125C59.224 59.0155 58.9073 58.2511 58.3438 57.6875L46.8125 46.1875V23.8125C46.821 23.408 46.7476 23.006 46.5966 22.6306C46.4457 22.2552 46.2205 21.9142 45.9344 21.6281C45.6483 21.342 45.3073 21.1168 44.9319 20.9658C44.5565 20.8149 44.1545 20.7415 43.75 20.75Z">\n                          </path>\n                        </svg>\n                        <span class="appstle_tooltip_title">'.concat(RS.Config.tooltipTitle,'</span>\n                        <div class="appstle_tooltip">\n                          <div class="appstle_tooltip_content">\n                              ').concat(RS.Config.tooltipDesctiption,"\n                          </div>\n                          ").concat(RS.Config.showAppstleLink?'<div class="appstle_tooltip_appstle">\n                            <a href="https://appstle.com/" class="appstle_link" target="_blank">\n                              POWERED BY APPSTLE\n                            </a>\n                          </div>':"<span></span>","\n                                        </div>\n                                      </div>")):RS.Config.showTooltip&&RS.Config.showStaticTooltip&&jQuery('<div class="appstle_tooltip_wrapper_static">'.concat(RS.Config.tooltipDesctiption,"</div>")),t&&t.appendTo(l),addSubscriptionItems(a,_),u=createJsonformat(),a.appendTo(l),o&&o.appendTo(l)),((w=product)===null||w===void 0||!w.available)&&((H=RS.Config)===null||H===void 0?void 0:H.widgetEnabledOnSoldVariant)=="false")return;jQuery(c).length&&(s=jQuery(c).first());var K=(m=RSConfig)===null||m===void 0||(Q=m.widgetTemplateHtml)===null||Q===void 0||(D=Q.replace("{% raw %}",""))===null||D===void 0?void 0:D.replace("{% endraw %}","");(M=u)!==null&&M!==void 0&&(q=M.sellingPlanVariants)!==null&&q!==void 0&&q.length&&K&&(l&&jQuery(l).remove(),l=jQuery(Mustache.render(K,u))),U==="BEFORE"?l.insertBefore(s):U==="AFTER"?l.insertAfter(s):U==="FIRST_CHILD"?l.prependTo(s):U==="LAST_CHILD"&&l.appendTo(s),updateWidgetElements(),jQuery(document).trigger("appstle_widget_updated")}i=y}}catch(z){console.error(z)}};setTimeout(function(){p(),updateWidgetUIBasedOnQueryParams()},13),attachMutationObserver('[name="id"]',p),standAloneElement?(standAloneElement.closest('form[action$="/cart/add"]').on("change",function(){var u,_;setTimeout(function(){var f,y,w,m;p(),updateHistoryState(),(f=window)!==null&&f!==void 0&&f._transcy&&((y=window)===null||y===void 0||(w=y._transcy)===null||w===void 0||(m=w.methods)===null||m===void 0||m.reConvertCurrency())},0<parseInt((u=RSConfig)===null||u===void 0?void 0:u.scriptLoadDelay)?parseInt((_=RSConfig)===null||_===void 0?void 0:_.scriptLoadDelay):30)}),standAloneElement.closest('form[action$="/cart/add"]').on("click",function(){var u,_;setTimeout(function(){var f,y,w,m;p(),updateHistoryState(),(f=window)!==null&&f!==void 0&&f._transcy&&((y=window)===null||y===void 0||(w=y._transcy)===null||w===void 0||(m=w.methods)===null||m===void 0||m.reConvertCurrency())},0<parseInt((u=RSConfig)===null||u===void 0?void 0:u.scriptLoadDelay)?parseInt((_=RSConfig)===null||_===void 0?void 0:_.scriptLoadDelay):30)}),standAloneElement.closest('form[action$="/cart/add"]').find("*").on("click",function(){var u,_;setTimeout(function(){var f,y,w,m;p(),updateHistoryState(),(f=window)!==null&&f!==void 0&&f._transcy&&((y=window)===null||y===void 0||(w=y._transcy)===null||w===void 0||(m=w.methods)===null||m===void 0||m.reConvertCurrency())},0<parseInt((u=RSConfig)===null||u===void 0?void 0:u.scriptLoadDelay)?parseInt((_=RSConfig)===null||_===void 0?void 0:_.scriptLoadDelay):30)})):(jQuery(document).on("change",function(){var u,_;setTimeout(function(){var f,y,w,m;p(),updateHistoryState(),(f=window)!==null&&f!==void 0&&f._transcy&&((y=window)===null||y===void 0||(w=y._transcy)===null||w===void 0||(m=w.methods)===null||m===void 0||m.reConvertCurrency())},0<parseInt((u=RSConfig)===null||u===void 0?void 0:u.scriptLoadDelay)?parseInt((_=RSConfig)===null||_===void 0?void 0:_.scriptLoadDelay):30)}),jQuery(document).on("click",function(){var u,_;setTimeout(function(){var f,y,w,m;p(),updateHistoryState(),(f=window)!==null&&f!==void 0&&f._transcy&&((y=window)===null||y===void 0||(w=y._transcy)===null||w===void 0||(m=w.methods)===null||m===void 0||m.reConvertCurrency())},0<parseInt((u=RSConfig)===null||u===void 0?void 0:u.scriptLoadDelay)?parseInt((_=RSConfig)===null||_===void 0?void 0:_.scriptLoadDelay):30)}))}if(urlIsAccountPage()===!0){var b=RSConfig.selectors.subscriptionLinkSelector,d=RSConfig.selectors.subscriptionLinkPlacement,C=RSConfig.manageSubscriptionBtnFormat;d.toLowerCase()==="after"?jQuery(b).after(C):d.toLowerCase()==="first_child"?jQuery(b).first(C):d.toLowerCase()==="last_child"?jQuery(b).last(C):jQuery(b).before(C),accountPageStyle()}};if(deferJquery(appstleSubscriptionFunction),jQuery(RSConfig.priceSelector).length){var _targetNode=document.querySelector(".product__info-wrapper div.no-js-hidden"),config1={attributes:!0,childList:!0,subtree:!0},callback=function(e,n){jQuery(RSConfig.priceSelector+'[data-appstle-price-modified="true"]').length||updateSellingPlanValueToFinalPrice()},_observer=new MutationObserver(callback);_targetNode&&config1&&_observer.observe(_targetNode,config1)}}function processProductVariants(e){if(e){for(var n=e.variants,t={},i={},a=0;a<n.length;a++){var l=n[a];t[l.title]=Object.assign({},l),i[l.id]=Object.assign({},l)}RSConfig.variantsByTitle=t,RSConfig.variantsById=i}}function detectVariant(e,n,t){var i,a,l,o=urlParam("variant");return o&&(i=RSConfig)!==null&&i!==void 0&&i.detectVariantFromURLParams?localVariantsById[o]:0<n.closest('form[action$="/cart/add"]').find("[name=id]").length&&n.closest('form[action$="/cart/add"]').find("[name=id]")[0].value?(o=n.closest('form[action$="/cart/add"]').find("[name=id]")[0].value,localVariantsById[o]):o?localVariantsById[o]:Object.values(localVariantsById).some(function(r){var s;return(r==null?void 0:r.title)==((s=$("form select[name='options[Bundle]']"))===null||s===void 0?void 0:s.val())})?Object.values(localVariantsById).find(function(r){return(r==null?void 0:r.title)==$("select[name='options[Bundle]']").val()}):(a=[],(l=n.closest('form[action$="/cart/add"]').find("select.single-option-selector"))!=null&&l.selectedIndex!=null&&l.selectedIndex!==-1?a.push(l[l.selectedIndex].value):a.push(void 0),localVariantsByTitle[a.join(" / ")]||t.variants[0])}function getSellingPlanAllocation(e,n){return localVariantsById[e].selling_plan_allocations.find(function(t){return t.selling_plan_id===n})}function compareCustomerTags(e,n){return e.filter(function(t){return n.indexOf(t)!=-1})}function isSellingPlanVisible(e){var n=__st.cid,t=RSConfig.customer_tags||[],i=!0;return!n&&RSConfig.memberOnlySellingPlansJson&&RSConfig.memberOnlySellingPlansJson[e]&&RSConfig.memberOnlySellingPlansJson[e].enableMemberInclusiveTag&&(i=!1),n&&RSConfig.nonMemberOnlySellingPlansJson&&RSConfig.nonMemberOnlySellingPlansJson[e]&&(i=!1),i&&n&&RSConfig.memberOnlySellingPlansJson&&RSConfig.memberOnlySellingPlansJson[e]&&(RSConfig.memberOnlySellingPlansJson[e].memberInclusiveTags&&RSConfig.memberOnlySellingPlansJson[e].memberInclusiveTags.trim()&&(i=0<compareCustomerTags(t,RSConfig.memberOnlySellingPlansJson[e].memberInclusiveTags.split(",")).length),RSConfig.memberOnlySellingPlansJson[e].memberExclusiveTags&&RSConfig.memberOnlySellingPlansJson[e].memberExclusiveTags.trim()&&(i=!(0<compareCustomerTags(t,RSConfig.memberOnlySellingPlansJson[e].memberExclusiveTags.split(",")).length))),i}function buildSellingPlantText(e){var n=e.totalPrice==e.formattedPrice?{sellingPlanName:e.name,sellingPlanPrice:'<span class="transcy-money">'.concat(e.formattedPrice,"</span>"),secondSellingPlanPrice:'<span class="transcy-money">'.concat(e.secondFormattedPrice,"</span>"),discountText:e==null?void 0:e.discountText,totalPrice:'<span class="transcy-money">'.concat(e==null?void 0:e.totalPrice,"</span>")}:{sellingPlanName:e.name,totalPrice:'<span class="transcy-money">'.concat(e==null?void 0:e.totalPrice,"</span>"),sellingPlanPrice:'<span class="transcy-money">'.concat(e.formattedPrice,"</span>"),secondSellingPlanPrice:'<span class="transcy-money">'.concat(e.secondFormattedPrice,"</span>"),discountText:e.discountText};return wrapPriceWithSpanTag(Mustache.render(RS.Config.sellingPlanTitleText,n))}function buildAtcButtonSelector(){var e=RSConfig.atcButtonSelector||"form[action$='/cart/add'] [type='submit']",n={productId:product.id};return e=Mustache.render(e,n)}function buildOneTimePriceText(e){var n={price:e};return wrapPriceWithSpanTag(Mustache.render(RS.Config.oneTimePriceText,n))}function buildSubscriptionOptionText(e,n){var t={discountValue:n};return wrapPriceWithSpanTag(Mustache.render(RS.Config.subscriptionOptionText,t))}function buildSelectedPriceText(e,n,t){var i=n?{pricePerDelivery:e,totalPrice:t}:{price:e},a=n?RS.Config.selectedPrepaidSellingPlanPriceText:RS.Config.selectedPayAsYouGoSellingPlanPriceText;return wrapPriceWithSpanTag(Mustache.render(a,i))}function buildPrepaidPerDeliveryPriceText(e){var n={prepaidPerDeliveryPrice:e};return wrapPriceWithSpanTag(Mustache.render(RS.Config.totalPricePerDeliveryText,n))}function buildSelectedTooltipPrePaidText(e,n){var t={pricePerDelivery:e,totalPrice:n},i=RS.Config.tooltipDescriptionOnPrepaidPlan;return wrapPriceWithSpanTag(Mustache.render(i,t))}function buildSelectedTooltipDiscountText(e,n){var t;if((e==null||(t=e.price_adjustments)===null||t===void 0?void 0:t.length)==2){var i,a,l={firstPrice:formatPriceWithQuantity(e==null||(i=e.price_adjustments[0])===null||i===void 0?void 0:i.price),secondPrice:formatPriceWithQuantity(e==null||(a=e.price_adjustments[1])===null||a===void 0?void 0:a.price),discountOne:0<n.length?n[0]:"",discountTwo:n.length==2?n[1]:""};return wrapPriceWithSpanTag(Mustache.render(RS.Config.tooltipDescriptionOnMultipleDiscount,l))}}function buildTooltipDetailsText(e,n,t){var i=n?{prepaidDetails:e,discountDetails:t,defaultTooltipDescription:RS.Config.tooltipDesctiption}:{defaultTooltipDescription:RS.Config.tooltipDesctiption,discountDetails:t},a=RS.Config.tooltipDescriptionCustomization;return wrapPriceWithSpanTag(Mustache.render(a,i))}function populateDropdown(purchaseOptions,variant){var sellingPlanVariants=[],validSellingPlanCounter=0;if(jQuery.each(product.selling_plan_groups,function(index,sellingPlanGroup){sellingPlanGroup.app_id==="appstle"&&jQuery.each(sellingPlanGroup.selling_plans,function(subIndex,sellingPlan){var visible=isSellingPlanVisible(sellingPlan.id);if(visible){var _RS2,_RS2$Config,_RSConfig3,sellingPlanAllocation=getSellingPlanAllocation(variant.id,sellingPlan.id);if(!sellingPlanAllocation)return;validSellingPlanCounter++;var price=sellingPlanAllocation.per_delivery_price,totalPrice=formatPriceWithQuantity(sellingPlanAllocation==null?void 0:sellingPlanAllocation.price),formattedPrice=formatPriceWithQuantity(price),compareAtPrice=sellingPlanAllocation.compare_at_price,formattedCompareAtPrice=formatPriceWithQuantity(compareAtPrice),secondPrice=null,secondFormattedPrice=null,discountText;secondFormattedPrice=sellingPlanAllocation&&sellingPlanAllocation.price_adjustments&&sellingPlanAllocation.price_adjustments.length===2?(secondPrice=sellingPlanAllocation.price_adjustments[1].price,formatPriceWithQuantity(secondPrice)):(secondPrice=price,formattedPrice);var priceAdjustment=sellingPlan==null?void 0:sellingPlan.price_adjustments[0];discountText=(priceAdjustment==null?void 0:priceAdjustment.value_type)!=="percentage"?formatPriceWithQuantity(priceAdjustment==null?void 0:priceAdjustment.value):(priceAdjustment==null?void 0:priceAdjustment.value)+"%";var jsonOfSellingPlans=(_RS2=RS)===null||_RS2===void 0||(_RS2$Config=_RS2.Config)===null||_RS2$Config===void 0?void 0:_RS2$Config.sellingPlansJson;if(jsonOfSellingPlans!=null&&jsonOfSellingPlans.length){var sellingPlanFrequency=jsonOfSellingPlans==null?void 0:jsonOfSellingPlans.find(function(e){var n,t;return(e==null||(n=e.id)===null||n===void 0||(t=n.split("/"))===null||t===void 0?void 0:t.pop())==sellingPlan.id}),sellingPlanFrequencyText;(sellingPlanFrequency==null?void 0:sellingPlanFrequency.frequencyInterval)==="MONTH"&&1<(sellingPlanFrequency==null?void 0:sellingPlanFrequency.frequencyCount)&&(sellingPlanFrequencyText=widgetLabels["appstle.subscription.wg.monthsFrequencyTextV2"]),(sellingPlanFrequency==null?void 0:sellingPlanFrequency.frequencyInterval)==="MONTH"&&(sellingPlanFrequency==null?void 0:sellingPlanFrequency.frequencyCount)===1&&(sellingPlanFrequencyText=widgetLabels["appstle.subscription.wg.monthFrequencyTextV2"]),(sellingPlanFrequency==null?void 0:sellingPlanFrequency.frequencyInterval)==="WEEK"&&1<(sellingPlanFrequency==null?void 0:sellingPlanFrequency.frequencyCount)&&(sellingPlanFrequencyText=widgetLabels["appstle.subscription.wg.weeksFrequencyTextV2"]),(sellingPlanFrequency==null?void 0:sellingPlanFrequency.frequencyInterval)==="WEEK"&&(sellingPlanFrequency==null?void 0:sellingPlanFrequency.frequencyCount)===1&&(sellingPlanFrequencyText=widgetLabels["appstle.subscription.wg.weekFrequencyTextV2"]),(sellingPlanFrequency==null?void 0:sellingPlanFrequency.frequencyInterval)==="DAY"&&1<(sellingPlanFrequency==null?void 0:sellingPlanFrequency.frequencyCount)&&(sellingPlanFrequencyText=widgetLabels["appstle.subscription.wg.daysFrequencyTextV2"]),(sellingPlanFrequency==null?void 0:sellingPlanFrequency.frequencyInterval)==="DAY"&&(sellingPlanFrequency==null?void 0:sellingPlanFrequency.frequencyCount)===1&&(sellingPlanFrequencyText=widgetLabels["appstle.subscription.wg.dayFrequencyTextV2"]),(sellingPlanFrequency==null?void 0:sellingPlanFrequency.frequencyInterval)==="YEAR"&&1<(sellingPlanFrequency==null?void 0:sellingPlanFrequency.frequencyCount)&&(sellingPlanFrequencyText=widgetLabels["appstle.subscription.wg.yearsFrequencyTextV2"]),(sellingPlanFrequency==null?void 0:sellingPlanFrequency.frequencyInterval)==="YEAR"&&(sellingPlanFrequency==null?void 0:sellingPlanFrequency.frequencyCount)===1&&(sellingPlanFrequencyText=widgetLabels["appstle.subscription.wg.yearFrequencyTextV2"])}var sellingPlanDetails={name:sellingPlan.name,description:sellingPlan.description,sellingPlanId:sellingPlan.id,formattedPrice:formattedPrice,compareAtPrice:compareAtPrice,formattedCompareAtPrice:formattedCompareAtPrice,price:price,totalPrice:totalPrice,secondPrice:secondPrice,secondFormattedPrice:secondFormattedPrice,sellingPlanFrequencyText:sellingPlanFrequencyText,discountText:priceAdjustment!=null&&priceAdjustment.value?discountText:null,formattedDiscountText:priceAdjustment!=null&&priceAdjustment.value?buildDiscountText(discountText):"",showFormattedDiscountText:!(priceAdjustment==null||!priceAdjustment.value),isChecked:!(validSellingPlanCounter!=1||subIndex!=0||!((_RSConfig3=RSConfig)!==null&&_RSConfig3!==void 0&&_RSConfig3.subscriptionOptionSelectedByDefault||product.requires_selling_plan)),formattedPrepaidPerDeliveryPriceText:buildPrepaidPerDeliveryPriceText(formattedPrice)};jQuery.extend(sellingPlanDetails,JSON.parse(JSON.stringify(getSellingPlanDetailsById(sellingPlan.id)))),sellingPlanDetails.id=sellingPlan.id,sellingPlanDetails.isFrequencySubsequent=1<sellingPlanDetails.frequencyCount,sellingPlanDetails.frequencyIntervalLowerCase=sellingPlanDetails.frequencyInterval.toLowerCase(),sellingPlanDetails.discountText===null?(sellingPlanDetails.secondFormattedDiscountText="",sellingPlanDetails.showSecondFormattedDiscountText=!1):(sellingPlanDetails.secondFormattedDiscountText=discountText+" ".concat(widgetLabels["appstle.subscription.wg.offFrequencyTextV2"]||"off"),sellingPlanDetails.showSecondFormattedDiscountText=!0),sellingPlanDetails.prepaidFlag=eval(sellingPlanDetails.prepaidFlag);var daysInBillingFrequency=1,totalDaysInBillingFrequency=0,sellingPlanFrequencyType="";sellingPlanDetails.billingFrequencyInterval==="WEEK"?(daysInBillingFrequency=7,sellingPlanFrequencyType="Weekly"):sellingPlanDetails.billingFrequencyInterval==="MONTH"?(daysInBillingFrequency=30,sellingPlanFrequencyType="Monthly"):sellingPlanDetails.billingFrequencyInterval==="YEAR"&&(daysInBillingFrequency=365,sellingPlanFrequencyType="Yearly"),sellingPlanDetails.prepaidFlag&&(sellingPlanFrequencyType="Prepay"),totalDaysInBillingFrequency=sellingPlanDetails.billingFrequencyCount*daysInBillingFrequency,sellingPlanDetails.pricePerDay=formatPrice(sellingPlanDetails.price*sellingPlanDetails.billingFrequencyCount/totalDaysInBillingFrequency)+"/".concat(widgetLabels["appstle.subscription.wg.dayFrequencyTextV2"]),sellingPlanDetails.sellingPlanFrequencyType=sellingPlanFrequencyType,0<sellingPlanDetails.price*sellingPlanDetails.billingFrequencyCount/totalDaysInBillingFrequency?sellingPlanDetails.showPricePerDay=!0:sellingPlanDetails.showPricePerDay=!1,sellingPlanVariants.push(sellingPlanDetails)}})}),0<sellingPlanVariants.length){var _RSConfig4;if(sellingPlanVariants.length<2){var _sellingPlanVariants$,_sellingPlanVariants$2;Selling_Plan_Variants_Global.multipleSellingPlan=!1,jQuery(purchaseOptions).find(".appstle_subscribe_option").children().hide();var singleSellingPlanDisplayText=buildSellingPlantText(sellingPlanVariants[0]);Selling_Plan_Variants_Global.singleSellingPlanDisplayText=singleSellingPlanDisplayText;var planText=jQuery('<div class="appstle_single_option_text">'.concat(singleSellingPlanDisplayText,"</div>")),_sellingPlanVariants$3,_sellingPlanVariants$4,_sellingPlanVariants$5,_sellingPlanVariants$6,_sellingPlanVariants$7;planText.appendTo(purchaseOptions.find(".appstle_subscribe_option")),(_sellingPlanVariants$=sellingPlanVariants[0])!==null&&_sellingPlanVariants$!==void 0&&_sellingPlanVariants$.description&&(_sellingPlanVariants$2=sellingPlanVariants[0])!==null&&_sellingPlanVariants$2!==void 0&&_sellingPlanVariants$2.description.includes("{{sellingPlanName}}")?jQuery('<div class="appstleSellingPlanDescription">'.concat((_sellingPlanVariants$3=sellingPlanVariants[0])===null||_sellingPlanVariants$3===void 0||(_sellingPlanVariants$4=_sellingPlanVariants$3.description)===null||_sellingPlanVariants$4===void 0?void 0:_sellingPlanVariants$4.replace("{{sellingPlanName}}",(_sellingPlanVariants$5=sellingPlanVariants[0])===null||_sellingPlanVariants$5===void 0?void 0:_sellingPlanVariants$5.name),"</div>")).appendTo(purchaseOptions.find(".appstle_subscribe_option")):(_sellingPlanVariants$6=sellingPlanVariants[0])!==null&&_sellingPlanVariants$6!==void 0&&_sellingPlanVariants$6.description&&jQuery('<div class="appstleSellingPlanDescription">'.concat((_sellingPlanVariants$7=sellingPlanVariants[0])===null||_sellingPlanVariants$7===void 0?void 0:_sellingPlanVariants$7.description,"</div>")).appendTo(purchaseOptions.find(".appstle_subscribe_option"))}else Selling_Plan_Variants_Global.multipleSellingPlan=!0;(_RSConfig4=RSConfig)!==null&&_RSConfig4!==void 0&&_RSConfig4.sortByDefaultSequence||sellingPlanVariants.sort(function(e,n){return e.price-n.price}),jQuery(sellingPlanVariants).each(function(e,n){var t,i=buildSellingPlantText(n);n.sellingPlanDisplayText=i,(t=RSConfig)!==null&&t!==void 0&&t.switchRadioButtonWidget?jQuery('<div>\n                  <input type="radio" id="'.concat(n.id,'" value="').concat(n.id,'" ').concat(e?"":"checked",' name="selling_plan_radio" style="display: inline;"></input>\n                  <label for="').concat(n.id,'" style="margin-top: 10px; ').concat(sellingPlanVariants.length<2?"display: none;":"",'">\n                    <span class="sellingplan">').concat(i,"</span>\n                  </label>\n                  ").concat(n!=null&&n.description&&n!=null&&n.description.includes("{{sellingPlanName}}")?'<div class="appstleSellingPlanDescription">'.concat(n==null?void 0:n.description.replace("{{sellingPlanName}}",n==null?void 0:n.name),"</div>"):n!=null&&n.description?'<div class="appstleSellingPlanDescription">'.concat(n==null?void 0:n.description,"</div>"):"","\n                </div>")).appendTo(purchaseOptions.find(".appstleRadioSellingPlanWrapper")):jQuery("<option />",{value:n.id,html:i}).appendTo(purchaseOptions.find("select"))}),Selling_Plan_Variants_Global.sellingPlanVariants=sellingPlanVariants}else try{jQuery("#appstle_subscription_widget"+widgetId).remove();var timer=setTimeout(function(){jQuery("#appstle_subscription_widget"+widgetId).remove(),clearTimeout(timer)})}catch(e){}return sellingPlanVariants}function hidePaymentButtons(){jQuery(RSConfig.selectors.payment_button_selectors).hide()}function showPaymentButtons(){jQuery(RSConfig.selectors.payment_button_selectors).show()}function urlIsAccountPage(){var e;return window.location.pathname==="/account"||((e=window.location.pathname)===null||e===void 0?void 0:e.endsWith("/account"))}function deferJquery(e){window.jQuery?e():setTimeout(function(){deferJquery(e)},50)}function addSubscriptionItems(e,n){var t;product.requires_selling_plan||jQuery('<div class="appstle_subscription_wrapper_option '.concat(product.requires_selling_plan||RS.Config.subscriptionOptionSelectedByDefault?"":"appstle_selected_background",'">\n              <input type="radio" ').concat(RS.Config.subscriptionOptionSelectedByDefault?"":"checked",' id="appstle_selling_plan_label_1').concat(widgetId,'" name="selling_plan" value="" ').concat(RS.Config.formMappingAttributeName&&RS.Config.formMappingAttributeSelector&&jQuery(RS.Config.formMappingAttributeSelector).length&&jQuery(RS.Config.formMappingAttributeSelector).attr("id")?"".concat(RS.Config.formMappingAttributeName,"=").concat(jQuery(RS.Config.formMappingAttributeSelector).attr("id")):"",' tabindex="1">\n          <label for="appstle_selling_plan_label_1').concat(widgetId,'" class="appstle_radio_label" >\n            <span class="appstle_circle" ><span class="appstle_dot"></span></span>\n              <span class="appstle_one_time_text">').concat(RS.Config.oneTimePurchaseText,'</span>\n             </label>\n          <span class="appstle_subscription_amount transcy-money"></span>\n         </div>')).appendTo(e);var i,a=jQuery('<div class="appstle_subscription_wrapper_option appstle_include_dropdown '.concat(product.requires_selling_plan||RS.Config.subscriptionOptionSelectedByDefault?"appstle_selected_background":"",'">\n            <div class="appstle_subscription_radio_wrapper">\n            <input type="radio" id="appstle_selling_plan_label_2').concat(widgetId,'" name="selling_plan" value="Subscribe and save" ').concat(product.requires_selling_plan||RS.Config.subscriptionOptionSelectedByDefault?"checked":""," ").concat(RS.Config.formMappingAttributeName&&RS.Config.formMappingAttributeSelector&&jQuery(RS.Config.formMappingAttributeSelector).length&&jQuery(RS.Config.formMappingAttributeSelector).attr("id")?"".concat(RS.Config.formMappingAttributeName,"=").concat(jQuery(RS.Config.formMappingAttributeSelector).attr("id")):"",' tabindex="2">\n                <label for="appstle_selling_plan_label_2').concat(widgetId,'" class="appstle_radio_label" >\n                    <span class="appstle_circle" ><span class="appstle_dot"></span></span>\n                    <span class="appstle_subscribe_save_text">').concat(RS.Config.subscriptionOptionText,'</span>\n                </label>\n                <div class="appstle_subscription_amount_wrapper">\n                  <span class="appstle_subscription_amount transcy-money"></span>\n                  <span class="appstle_subscription_compare_amount transcy-money"></span>\n                </div>\n            </div>\n            <div class="appstle_subscribe_option ').concat(product.requires_selling_plan||RS.Config.subscriptionOptionSelectedByDefault?"":"appstle_hide_subsOption",'">\n                ').concat(RS.Config.sellingPlanSelectTitle?'<label for="appstle_selling_plan'.concat(widgetId,'" class="appstle_select_label">').concat(RS.Config.sellingPlanSelectTitle,"</label>"):"","\n                ").concat((t=RSConfig)!==null&&t!==void 0&&t.switchRadioButtonWidget?'<div class="appstleRadioSellingPlanWrapper"></div>':' <select id="appstle_selling_plan'.concat(widgetId,'" class="appstle_select">\n                </select><div class="appstleSelectedSellingPlanOptionDescription"></div>'),"\n\n            </div>\n        </div>")),l=populateDropdown(a,n);l&&0<l.length&&((i=RSConfig)!==null&&i!==void 0&&i.showSubOptionBeforeOneTime?a.prependTo(e):a.appendTo(e)),addStyle(widgetId)}function changeEventHandlerForRadio(){jQuery("#appstle_subscription_widget"+widgetId).find(".appstle_subscription_wrapper input[type=radio]").on("change",function(){var e=jQuery("#appstle_subscription_widget"+widgetId+" .appstle_subscribe_option"),n=jQuery("#appstle_subscription_widget"+widgetId+" .appstleLoyaltyTable");0<e.length&&(checkIfSellingPlanGroupIsSelected()?(e.removeClass("appstle_hide_subsOption"),jQuery("#appstle_subscription_widget"+widgetId+" .appstle_subscription_wrapper_option.appstle_include_dropdown").addClass("appstle_selected_background"),jQuery("#appstle_subscription_widget"+widgetId+" .appstle_subscription_wrapper_option:not(.appstle_include_dropdown)").removeClass("appstle_selected_background"),n.show(),dispatchAppstleEvent("SellingPlanSelected")):(jQuery("#appstle_subscription_widget"+widgetId+" .appstle_subscription_wrapper_option.appstle_include_dropdown").removeClass("appstle_selected_background"),jQuery("#appstle_subscription_widget"+widgetId+" .appstle_subscription_wrapper_option:not(.appstle_include_dropdown)").first().addClass("appstle_selected_background"),e.addClass("appstle_hide_subsOption"),n.hide(),dispatchAppstleEvent("SellingPlanRemoved"))),updateStateOfWidget()})}function updateFormFields(e){if(jQuery(".appstle_fields_wrapper"+widgetId).remove(),jQuery(RSConfig.atcButtonSelector).parents("form").removeAttr("novalidate"),e){var n=RSConfig.sellingPlansJson;if(n){var t=jQuery('<div class="appstle_fields_wrapper appstle_fields_wrapper'.concat(widgetId,'"></div>')),i=n==null?void 0:n.find(function(l){return l.id=="gid://shopify/SellingPlan/".concat(e)});if(!i)return;var a=JSON.parse((i==null?void 0:i.formFieldJson)||null);a&&0<a.length&&(t.insertBefore("#appstle_subscription_widget"+widgetId+" .appstle_widget_title"),a.forEach(function(l,o){l.type==="date"?(t.append(jQuery('\n                    <div class="appstleOrderDatePicker" '.concat(l.visible?"":'style="display: none;"','>\n                      <label class="appstleFormFieldLabel appstleOrderDatePickerLabel" for="properties[_order-date]">').concat(l.label,'</label>\n                      <div class="as-date-input-wrapper">\n                        <input class="appstle_form_field_input" type="text">\n                        <input class="appstle_form_field_input_alternate" type="hidden">\n                        <input name="properties[_order-date]" value="" class="appstle_form_field_input_iso" type="hidden">\n                      </div>\n                    </div>'))),getJqueryUIFromCDN(),attatchDatePicker(l.config,l.enabledDays)):l.type==="text"&&t.append(jQuery('\n                    <div class="appstleCustomTextField" '.concat(l.visible?"":'style="display: none;"','>\n                      <label class="appstleFormFieldLabel appstleCustomTextFieldLabel" for="properties[').concat(l.name,']">').concat(l.label,'</label>\n                      <div class="as-customTextField-wrapper">\n                        <input name="properties[').concat(l.name,']" ').concat(l!=null&&l.required?"required":"",' value="" type="text" class="appstle_form_field_text_input">\n                      </div>\n                    </div>')))}),jQuery("#appstle_subscription_widget"+widgetId+" .appstle_form_field_input_alternate").on("change",function(l){var o=l.target.value+"T"+new Date().toISOString().split("T")[1];jQuery(".appstle_form_field_input_iso").attr("value",new Date(o).toISOString().split(".")[0]+"Z"),jQuery(".appstle_form_field_input_iso").val(new Date(o).toISOString().split(".")[0]+"Z")}))}}}function getJqueryUIFromCDN(){if(!jQuery(".jqueryUIFetched").length&&jQuery.datepicker===void 0){var e=document.createElement("script");e.src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js",e.type="text/javascript",head.appendChild(e);var n=document.createElement("link");n.href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css",n.rel="stylesheet",head.appendChild(n),jQuery("html").addClass("jqueryUIFetched")}}function attatchDatePicker(e,n){var t=new Date;if(jQuery.datepicker){if(jQuery("#appstle_subscription_widget"+widgetId+" .appstle_form_field_input_iso").length){var i={altField:"#appstle_subscription_widget"+widgetId+" .appstle_form_field_input_alternate",altFormat:"yy-mm-dd",autoSize:!0,minDate:t,showOn:"both",buttonImage:"https://ik.imagekit.io/mdclzmx6brh/calendar_month_FILL0_wght400_GRAD0_opsz48_iJLonfrRJ.png",defaultDate:t,currentText:"Now",beforeShowDay:function(l){var o;if(n&&(o=n)!==null&&o!==void 0&&o.length){var r,s=new Date(l);return typeof n=="string"&&(n=JSON.parse(n)),((r=n)===null||r===void 0?void 0:r.map(function(c){return parseInt(c==null?void 0:c.value)})).indexOf(s.getDay())!==-1?[!0]:[!1]}return[!0]},onSelect:function(){$(this).parents(".as-date-input-wrapper").find("input").trigger("change")}};e=e?JSON.parse(e):{};var a=jQuery.extend({},i,e);jQuery("#appstle_subscription_widget"+widgetId+" .appstle_form_field_input").datepicker(a),jQuery("#appstle_subscription_widget"+widgetId+" .appstle_form_field_input").datepicker("setDate",t),jQuery("#appstle_subscription_widget"+widgetId+" .appstle_form_field_input").parents(".as-date-input-wrapper").find("input").trigger("change")}}else setTimeout(function(){return attatchDatePicker(e,n)},30)}function changeHandlerForSelect(){var e;(e=RSConfig)!==null&&e!==void 0&&e.switchRadioButtonWidget?jQuery("#appstle_subscription_widget"+widgetId+" .appstle_subscribe_option input").on("change",function(n){updateStateOfWidget(),updateFormFields(getCurrentSellingPlanId())}):jQuery("#appstle_subscription_widget"+widgetId+" .appstle_subscription_wrapper select").on("change",function(n){updateStateOfWidget(),updateFormFields(getCurrentSellingPlanId())}),jQuery("#appstle_subscription_widget"+widgetId+' input[name="selling_plan"]').on("change",function(n){updateStateOfWidget(),updateFormFields(getCurrentSellingPlanId())}),updateFormFields(getCurrentSellingPlanId())}function triggerChangeEvent(e){jQuery(e).change()}function registerAndTriggerEventsForFormFields(){changeEventHandlerForRadio(),changeHandlerForSelect()}function unbindEventListeners(){jQuery(".appstle_subscription_wrapper input[type=radio], .appstle_subscription_wrapper select").off("change")}function getSelectedSellingPlanPrice(){var e=getSelectedSellingPlanId();return e?formatPriceWithQuantity(getSellingPlanAllocation(localWindowVariant.id,parseInt(e)).per_delivery_price):null}function getCurrentQuantity(){var e,n,t=jQuery(buildAtcButtonSelector()).first();return Array.prototype.slice.call(t.parents((e=RSConfig)===null||e===void 0?void 0:e.widgetParentSelector).find((n=RSConfig)===null||n===void 0?void 0:n.quantitySelector)).map(function(i){return Number($(i).val())}).reduce(function(i,a){return Math.max(i,a)},-1/0)}function getCurrentQuantityPrice(e){var n;return e*(((n=RSConfig)===null||n===void 0?void 0:n.updatePriceOnQuantityChange)==="true"&&parseInt(getCurrentQuantity())||1)}function formatPriceWithQuantity(e){return formatPrice(getCurrentQuantityPrice(e))}function getSelectedSellingPlanId(){var e=null;try{var n;(n=RSConfig)!==null&&n!==void 0&&n.switchRadioButtonWidget?(e=jQuery("#appstle_subscription_widget"+widgetId).find(".appstle_subscribe_option input:checked").val())||(e=jQuery("#appstle_subscription_widget"+widgetId).find('input[name="selling_plan"]:checked').val()):e=jQuery("#appstle_subscription_widget"+widgetId).find(".appstle_subscription_wrapper_option.appstle_include_dropdown select").val()}catch(t){}return e}function getCurrentSellingPlanId(){var e=null;try{e=jQuery("#appstle_subscription_widget"+widgetId).find("input[name=selling_plan]:checked").val()}catch(n){}return e}function getVariantId(){var e,n=urlParam("variant");return n&&(e=RSConfig)!==null&&e!==void 0&&e.detectVariantFromURLParams?n:standAloneElement?jQuery(standAloneElement).closest('form[action$="/cart/add"]').find("[name=id]")[0]==null?localWindowVariant.id:jQuery(standAloneElement).closest('form[action$="/cart/add"]').find("[name=id]")[0].value:jQuery("#appstle_subscription_widget"+widgetId).closest('form[action$="/cart/add"]').find("[name=id]")[0]==null?localWindowVariant.id:jQuery("#appstle_subscription_widget"+widgetId).closest('form[action$="/cart/add"]').find("[name=id]")[0].value}function updateOneTimePurchaseValueToRadio(){var e,n,t=getVariantId(),i=null;standAloneElement?i=(standAloneProduct==null?void 0:standAloneProduct.variants.filter(function(a){return String(a==null?void 0:a.id)===String(t)})).pop().price:i=(e=RSConfig)===null||e===void 0||(n=e.variantsById[t])===null||n===void 0?void 0:n.price,jQuery("#appstle_subscription_widget"+widgetId+" .appstle_subscription_wrapper_option:not(.appstle_include_dropdown) .appstle_subscription_amount").html(wrapPriceWithSpanTag(buildOneTimePriceText(formatPriceWithQuantity(i))))}function appendSellingPlanDescription(e){e&&$("#appstle_subscription_widget".concat(widgetId," .appstleSelectedSellingPlanOptionDescription")).length===0&&checkIfSellingPlanGroupIsSelected()&&(jQuery("#appstle_subscription_widget".concat(widgetId," .widgetSellingPlanWrapper")).length?$("<div class='appstleSelectedSellingPlanOptionDescription'>${sellingPlanDescription}</div>").insertAfter("#appstle_subscription_widget".concat(widgetId," .widgetSellingPlanWrapper")):$("<div class='appstleSelectedSellingPlanOptionDescription'>${sellingPlanDescription}</div>").appendTo("#appstle_subscription_widget".concat(widgetId," .appstle_subscribe_option")))}function updateSelectValueToRadio(){var e=getSelectedSellingPlanId();if(jQuery("#appstle_subscription_widget"+widgetId+" .appstleSelectedSellingPlanOptionDescription").remove(),jQuery("#appstle_subscription_widget".concat(widgetId)).find('[name="properties[_fulfillments-count]"]').remove(),e){var n=getVariantId();getLoyaltyProductData(e,checkIfSellingPlanGroupIsSelected());var t=getSellingPlanAllocation(n,parseInt(e)),i=formatPriceWithQuantity(t.per_delivery_price),a=(wrapPriceWithSpanTag(formatPriceWithQuantity(product.price)),getSellingPlanDetails(t==null?void 0:t.selling_plan_group_id,t==null?void 0:t.selling_plan_id)),l=(a==null?void 0:a.description)||"";jQuery("#appstle_subscription_widget"+widgetId+" #appstle_selling_plan_label_2"+widgetId).attr("value",e);var o=t.per_delivery_price!==t.price,r=wrapPriceWithSpanTag(buildSelectedPriceText(i,o,formatPriceWithQuantity(t.price))),s=getSellingPlanDiscountPercentage(),c=getSellingPlanDiscountPercentage(!0),p=buildTooltipDetailsText(buildSelectedTooltipPrePaidText(i,formatPriceWithQuantity(t.price)),o,buildSelectedTooltipDiscountText(t,c)),b=buildSubscriptionOptionText(o,s),d=buildPrepaidPerDeliveryPriceText(i);jQuery("#appstle_subscription_widget"+widgetId+" .appstle_prepaid_description").remove(),jQuery("#appstle_subscription_widget"+widgetId+" .appstle_subscription_wrapper_option.appstle_include_dropdown .appstle_subscription_amount").html(r),jQuery("#appstle_subscription_widget"+widgetId+" .appstle_subscription_wrapper_option.appstle_include_dropdown .appstle_subscription_compare_amount ").html(""),o&&d&&jQuery("#appstle_subscription_widget"+widgetId+" .appstle_subscription_amount_wrapper").append('<div class="appstle_prepaid_description transcy-money">'.concat(wrapPriceWithSpanTag(d)||wrapPriceWithSpanTag(formatPriceWithQuantity(t.price))+"/delivery","</div>")),jQuery("#appstle_subscription_widget"+widgetId+" .appstle_subscription_wrapper_option.appstle_include_dropdown .appstle_subscription_radio_wrapper .appstle_subscribe_save_text").html(b),checkIfSellingPlanGroupIsSelected()&&p&&p.trim()?RS.Config.showStaticTooltip?jQuery("#appstle_subscription_widget"+widgetId+" .appstle_tooltip_wrapper_static").html(p):jQuery("#appstle_subscription_widget"+widgetId+" .appstle_tooltip_wrapper .appstle_tooltip .appstle_tooltip_content").html(p):(jQuery(".appstleSelectedSellingPlanOptionDescription").remove(),RS.Config.showStaticTooltip&&RS.Config.tooltipDesctiption&&RS.Config.tooltipDesctiption.trim()?jQuery("#appstle_subscription_widget"+widgetId+" .appstle_tooltip_wrapper_static").html(RS.Config.tooltipDesctiption):jQuery("#appstle_subscription_widget"+widgetId+" .appstle_tooltip_wrapper .appstle_tooltip .appstle_tooltip_content").html(RS.Config.tooltipDesctiption));var C=l.includes("{{sellingPlanName}}")?l.replace("{{sellingPlanName}}",a==null?void 0:a.name):l;if(l&&appendSellingPlanDescription(l),jQuery("#appstle_subscription_widget"+widgetId+" .appstleSelectedSellingPlanOptionDescription").html(C),jQuery("#appstle_subscription_widget".concat(widgetId)).find('[name="selling_plan"]:checked').val()&&widgetLabels["appstle.subscription.wg.allowFulfilmentCountViaPropertiesV2"]==="true"){var u=a.options[0].value.match(/(\d+)/g)[1]/a.options[0].value.match(/(\d+)/g)[0];jQuery("#appstle_subscription_widget".concat(widgetId)).append('<input type=hidden name="properties[_fulfillments-count]" value="'.concat(u,'">'))}}}function getLoyaltyProductData(e,n){var t,i,a,l,o=(t=RSConfig)===null||t===void 0||(i=t.sellingPlansJson)===null||i===void 0?void 0:i.find(function(s){return(s==null?void 0:s.id.split("/").pop())===String(e)}),r=[];o!=null&&(a=o.appstleCycles)!==null&&a!==void 0&&a.length&&(o==null||(l=o.appstleCycles)===null||l===void 0||l.forEach(function(s){r.push(s==null?void 0:s.freeProductHandle)})),getAllProductData(r,e,n)}function getAllProductData(e,n,t){var i,a,l=e.shift();l?(i=window)!==null&&i!==void 0&&(a=i.products)!==null&&a!==void 0&&a[l]?e.length?getAllProductData(e,n,t):createLoyaltyTableData(n,t):fetch("/products/".concat(l,".js")).then(function(o){if(o.ok)return o.json()}).then(function(o){window.products||(window.products={}),window.products[l]=o,e.length?getAllProductData(e,n,t):createLoyaltyTableData(n,t)}):e.length?getAllProductData(e,n,t):createLoyaltyTableData(n,t)}function createLoyaltyTableData(e,n){var t,i,a,l,o=[];jQuery("#appstle_subscription_widget"+widgetId+" .appstleLoyaltyTable").remove();var r,s=(t=RSConfig)===null||t===void 0||(i=t.sellingPlansJson)===null||i===void 0?void 0:i.find(function(d){return(d==null?void 0:d.id.split("/").pop())===String(e)}),c=null;s!=null&&s.freeTrialEnabled&&o.push({perkText:getPerkText(0,s.freeTrialCount,s.freeTrialInterval,s==null?void 0:s.freeTrialEnabled)}),s!=null&&s.afterCycle2&&0<parseFloat(s.discountOffer2)&&o.push({perkText:getPerkText(getBillingCycleText(s.afterCycle2),s.discountOffer2,s.discountType2,!1)}),s!=null&&(a=s.appstleCycles)!==null&&a!==void 0&&a.length&&(s==null||(r=s.appstleCycles)===null||r===void 0||r.forEach(function(d){var C="",u="",_="";if(d.discountType==="FREE_PRODUCT"){var f,y,w,m,Q,D,M,q,H,U,K,z,se,fe,re,Y;C=(f=window)===null||f===void 0||(y=f.products)===null||y===void 0||(w=y[d.freeProductHandle])===null||w===void 0?void 0:w.title,1<((m=window)===null||m===void 0||(Q=m.products)===null||Q===void 0||(D=Q[d.freeProductHandle])===null||D===void 0?void 0:D.variants.length)&&(C=C+" - "+((Y=((se=window)===null||se===void 0||(fe=se.products)===null||fe===void 0||(re=fe[d.freeProductHandle])===null||re===void 0?void 0:re.variants.filter(function(he){return he.id===parseInt(d==null?void 0:d.freeVariantId)})).pop())===null||Y===void 0?void 0:Y.title)),_=(M=window)===null||M===void 0||(q=M.products)===null||q===void 0||(H=q[d.freeProductHandle])===null||H===void 0?void 0:H.featured_image,u=formatPrice((U=window)===null||U===void 0||(K=U.products)===null||K===void 0||(z=K[d.freeProductHandle])===null||z===void 0?void 0:z.price)}(0<parseFloat(d.value)||C||d.discountType==="SHIPPING")&&o.push({perkText:getPerkText(getBillingCycleText(d.afterCycle),d.value,d.discountType,!1,C,_,u)})}));var p=((l=RSConfig)===null||l===void 0?void 0:l.loyaltyDetailsLabelText)||"Subscriber Rewards";if(o.length){var b='<div class="appstleLoyaltyTable" '.concat(n?"":'style="display: none;"','><table width="100%">\n                        <div class="appstle_loyalty_title">').concat(p,"</div>\n                        <tbody>\n                          {{#items}}\n                            <tr>\n                              <td>{{{perkText}}}</td>\n                            </tr>\n                           {{/items}}\n                        </tbody>\n                      </table></div>");o={items:o},c=Mustache.render(b,o),jQuery(c).insertAfter("#appstle_subscription_widget"+widgetId+" .appstle_subscription_wrapper")}}function getPerkText(e,n,t,i,a,l,o){if(JSON.parse(RS.Config.labels)["appstle.subscription.wg.loyaltyPerkDescriptionTextV2"]){var r={discount:n,discountType:t,formatDiscountedPrice:formatPrice(100*n),freeProductName:a,isDiscountTypePercentage:t==="PERCENTAGE",isDiscountTypeShipping:t==="SHIPPING",isDiscountTypeFreeProduct:t==="FREE_PRODUCT",isDiscountTypeFixed:t==="FIXED",isFreeTrial:i,isCartPage:!1,featured_image:l,productPrice:o,billingCycleBlock:'<span class="appstle-loyalty-billing-cycle"><span class="appstle-loyalty-billing-cycle-count">'.concat(e,"</span>")};return Mustache.render(JSON.parse(RS.Config.labels)["appstle.subscription.wg.loyaltyPerkDescriptionTextV2"],r)}return t==="PERCENTAGE"?'After <span class="appstle-loyalty-billing-cycle"><span class="appstle-loyalty-billing-cycle-count">'.concat(e,'</span> order</span>, <span class="appstle-loyalty-discount">get <span class="appstle-loyalty-discount-amount">').concat(n+"% off","</span></span>."):t==="SHIPPING"?'After <span class="appstle-loyalty-billing-cycle"><span class="appstle-loyalty-billing-cycle-count">'.concat(e,'</span> order</span>, <span class="appstle-loyalty-discount">get <span class="appstle-loyalty-discount-amount">',"shipping at ".concat(formatPrice(100*n)),"</span></span>."):t==="FREE_PRODUCT"?'After <span class="appstle-loyalty-billing-cycle"><span class="appstle-loyalty-billing-cycle-count">'.concat(e,'</span> order</span>, <span class="appstle-loyalty-discount">get <span class="appstle-loyalty-discount-amount">FREE PRODUCT (').concat(a,")</span></span>."):t==="FIXED"?'After <span class="appstle-loyalty-billing-cycle"><span class="appstle-loyalty-billing-cycle-count">'.concat(e,'</span> order</span>, <span class="appstle-loyalty-discount">get <span class="appstle-loyalty-discount-amount">').concat(formatPrice(100*n)+" off","</span></span>."):i?'Get <span class="appstle-loyalty-free-trial-discount">'.concat(n,' <span class="appstle-loyalty-free-trial-discount-count" style="text-transform: lowercase;">').concat(t).concat(1<n?"s":"",'</span></span> <span class="appstle-loyalty-free-trial-text">free trial.</span>'):t==="PERCENTAGE"?'After <span class="appstle-loyalty-billing-cycle"><span class="appstle-loyalty-billing-cycle-count">'.concat(e,'</span> order</span>, <span class="appstle-loyalty-discount">get <span class="appstle-loyalty-discount-amount">').concat(n+"% off","</span></span>."):t==="SHIPPING"?'After <span class="appstle-loyalty-billing-cycle"><span class="appstle-loyalty-billing-cycle-count">'.concat(e,'</span> order</span>, <span class="appstle-loyalty-discount">get <span class="appstle-loyalty-discount-amount">',"shipping at ".concat(formatPrice(100*n)),"</span></span>."):t==="FREE_PRODUCT"?'After <span class="appstle-loyalty-billing-cycle"><span class="appstle-loyalty-billing-cycle-count">'.concat(e,'</span> order</span>, <span class="appstle-loyalty-discount">get <span class="appstle-loyalty-discount-amount">FREE PRODUCT (').concat(a,")</span></span>."):t==="FIXED"?'After <span class="appstle-loyalty-billing-cycle"><span class="appstle-loyalty-billing-cycle-count">'.concat(e,'</span> order</span>, <span class="appstle-loyalty-discount">get <span class="appstle-loyalty-discount-amount">').concat(formatPrice(100*n)+" off","</span></span>."):void 0}function getSellingPlanDetails(e,n){var t,i,a=((t=product)===null||t===void 0?void 0:t.selling_plan_groups.filter(function(l){return(l==null?void 0:l.id)===e})).pop();return(a==null||(i=a.selling_plans)===null||i===void 0?void 0:i.filter(function(l){return(l==null?void 0:l.id)===n})).pop()}function getSellingPlanDetailsById(e){var n,t;return(n=RSConfig)===null||n===void 0||(t=n.sellingPlansJson)===null||t===void 0?void 0:t.find(function(i){return(i==null?void 0:i.id.split("/").pop())===String(e)})}function checkIfSellingPlanGroupIsSelected(){var e=!1;try{e=jQuery("#appstle_subscription_widget"+widgetId).find("[name=selling_plan]:checked").val()}catch(n){}return e}function buildDiscountText(e){var n={selectedDiscountPercentage:e};return wrapPriceWithSpanTag(Mustache.render(RS.Config.selectedDiscountFormat,n))}function updateSellingPlanValueToFinalPrice(){var e,n,t,i,a,l={regular:{sellingPrice:RSConfig.priceSelector,saleBadgeTop:RSConfig.badgeTop}}.regular;(e=RSConfig)!==null&&e!==void 0&&e.widgetParentSelector?(jQuery("#appstle_subscription_widget"+widgetId).parents((t=RSConfig)===null||t===void 0?void 0:t.widgetParentSelector).find(".appstle_subscription_final_price").remove(),jQuery("#appstle_subscription_widget"+widgetId).parents((i=RSConfig)===null||i===void 0?void 0:i.widgetParentSelector).find(".appstle_subscription_element").remove(),jQuery("#appstle_subscription_widget"+widgetId).parents((a=RSConfig)===null||a===void 0?void 0:a.widgetParentSelector).find(".appstle_subscription_compare_price").remove()):(jQuery(".appstle_subscription_final_price").remove(),jQuery(".appstle_subscription_element").remove(),jQuery(".appstle_subscription_compare_price").remove());var o,r=getSelectedSellingPlanPrice(),s=getSellingPlanDiscountPercentage(),c=jQuery(l.sellingPrice);if((n=RSConfig)!==null&&n!==void 0&&n.widgetParentSelector&&(c=jQuery("#appstle_subscription_widget"+widgetId).parents((o=RSConfig)===null||o===void 0?void 0:o.widgetParentSelector).find(l.sellingPrice)),c.css("text-decoration",""),c.removeAttr("data-appstle-price-modified"),l.sellingPrice&&s){if(checkIfSellingPlanGroupIsSelected()){var p=buildDiscountText(s);if(p){var b=jQuery('<span class="appstle_subscription_element appstle_subscription_save"> '.concat(p," </span>"));b&&b.css("top",l.saleBadgeTop);var d=c.first().clone();d.addClass("appstle_subscription_final_price"),d.html(r);var C=getAttributes(d);Object.keys(C).forEach(function(u){u!=="class"&&u!=="style"&&d.removeAttr(u)}),c.css("text-decoration","line-through"),0<d.length&&d.insertBefore(c),b.insertAfter(c)}}c.attr("data-appstle-price-modified",!0)}else c.attr("data-appstle-price-modified",!0)}function getAttributes(e){var n,t={};return e&&0<e.length&&$.each((n=e[0])===null||n===void 0?void 0:n.attributes,function(i,a){t[a.name]=a.value}),t}function getSellingPlanDiscountPercentage(e){var n,t,i,a,l;if(!(l=parseInt(getSelectedSellingPlanId())))return null;if(product.selling_plan_groups.forEach(function(p){p.app_id==="appstle"&&p.selling_plans.forEach(function(b){isSellingPlanVisible(b.id)&&b.id===l&&(a=p)})}),a.selling_plans.forEach(function(p){p.id===l&&(l=p)}),e&&((n=l)===null||n===void 0||(t=n.price_adjustments)===null||t===void 0?void 0:t.length)==2){var o,r,s=[];return(o=l)===null||o===void 0||(r=o.price_adjustments)===null||r===void 0||r.forEach(function(p){(p==null?void 0:p.value_type)!=="percentage"?s.push(formatPriceWithQuantity(p==null?void 0:p.value)):s.push((p==null?void 0:p.value)+"%")}),s}var c=(i=l)===null||i===void 0?void 0:i.price_adjustments[0];return c==null||c.value==null||c.value==0?null:(c==null?void 0:c.value_type)!=="percentage"?formatPriceWithQuantity(c==null?void 0:c.value):(c==null?void 0:c.value)+"%"}function updateWidgetElements(){registerAndTriggerEventsForFormFields(),updateStateOfWidget()}function updateStateOfWidget(){updateSelectValueToRadio(),updateOneTimePurchaseValueToRadio(),updateSellingPlanValueToFinalPrice(),setTimeout(function(){return updateFormFields(getCurrentSellingPlanId())},30),dispatchAppstleEvent("SubscriptionWidgetUpdated"),jQuery(".appstle-hidden").removeClass("appstle-hidden")}function createJsonformat(){var e,n,t,i={},a=getVariantId(),l=null;return standAloneElement?l=(standAloneProduct==null?void 0:standAloneProduct.variants.filter(function(o){return String(o==null?void 0:o.id)===String(a)})).pop().price:l=(n=RSConfig)===null||n===void 0||(t=n.variantsById[a])===null||t===void 0?void 0:t.price,i.requires_selling_plan=(e=product)===null||e===void 0?void 0:e.requires_selling_plan,i.oneTimePuchaseText=RS.Config.oneTimePurchaseText,i.oneTimePuchaseAmount=buildOneTimePriceText(formatPriceWithQuantity(l)),i.subscribeText=RS.Config.subscriptionOptionText,i.widgetId=widgetId,(i=Object.assign(Selling_Plan_Variants_Global,i)).tooltipTitle=RS.Config.tooltipTitle,i.toolTipDescription=RS.Config.tooltipDesctiption,i.companyWebsite="https://appstle.com/",i.companyName="POWERED BY APPSTLE",i.showStaticTooltip=RS.Config.showStaticTooltip,i.purchaseOptionsText=RS.Config.purchaseOptionsText,i.deliveryFrequencyText=RS.Config.sellingPlanSelectTitle,i.showAppstleLink=RS.Config.showAppstleLink,i.subscriptionOptionSelectedDefault=RS.Config.subscriptionOptionSelectedByDefault,i.showSubOptionBeforeOneTime=RS.Config.showSubOptionBeforeOneTime,i.showTooltip=RS.Config.showTooltip,i.oneTimeFrequencyText=widgetLabels["appstle.subscription.wg.oneTimeFrequencyTextV2"],i}function getCssAsString(e){var n={};return e?(Object.keys(e).forEach(function(t){e[t]&&(n[t]=e[t])}),JSON.stringify(n).split('"').join("").split("{").join("").split("}").join("").split(",").join(";")):""}function updateHistoryState(){if(localWindowVariant){var e=localWindowVariant.id;if(history.replaceState&&e){var n=window.location.protocol+"//"+window.location.host+window.location.pathname+"?";if(checkIfSellingPlanGroupIsSelected()){var t=getSelectedSellingPlanId();t&&(n+="selling_plan="+t+"&")}(n+="variant="+e)!==location.href&&window.history.replaceState({path:n},"",n)}}}function updateWidgetUIBasedOnQueryParams(){if(jQuery("#appstle_subscription_widget"+widgetId).length!==0){var e=urlParamsToObject(),n=jQuery("#appstle_subscription_widget"+widgetId).closest('form[action$="/cart/add"]');if((0<n.find("input[value="+e.variant+"]").length||0<n.find("option[value="+e.variant+"]").length)&&(0<n.find("option[value="+e.selling_plan+"]").length||0<n.find("input[value="+e.selling_plan+"]").length)&&e.selling_plan){var t,i,a=jQuery("#appstle_subscription_widget"+widgetId+" #appstle_selling_plan_label_2"+widgetId);a.length&&(a[0].checked=!0);var l,o=null;o=(t=RSConfig)!==null&&t!==void 0&&t.switchRadioButtonWidget?jQuery("#appstle_subscription_widget"+widgetId+" .appstle_subscribe_option"):jQuery("#appstle_subscription_widget"+widgetId+" select#appstle_selling_plan"+widgetId),(i=RSConfig)!==null&&i!==void 0&&i.switchRadioButtonWidget?(l=o)!==null&&l!==void 0&&l.length?o.find("input[type=radio]").each(function(r,s){$(s).removeAttr("checked"),jQuery(s).attr("value")===e.selling_plan&&$(s).attr("checked",!0)}):jQuery("#appstle_subscription_widget"+widgetId).find("input[type=radio]").each(function(r,s){$(s).removeAttr("checked"),jQuery(s).attr("value")===e.selling_plan&&$(s).attr("checked",!0)}):o.find("option").each(function(r,s){jQuery(s).attr("value")===e.selling_plan&&(o[0].selectedIndex=r)}),a.change(),o.change()}}}function accountPageStyle(){var e=RSConfig.css;jQuery("<style>".concat(e.customCSS,"</style>")).appendTo(jQuery("head"))}function addStyle(e){var n=RSConfig.css;jQuery("<style>\n\n     #appstle_subscription_widget".concat(e,"{\n            width: 100%;\n            text-align: left;\n            margin-top: 17px;\n            clear: both;\n            max-width: 400px;\n            ").concat(getCssAsString(n.appstle_subscription_widget),"\n        }\n\n        #appstle_subscription_widget").concat(e,"{\n          ").concat(getCssAsString(n.appstle_widget_text_color),"\n        }\n\n          #appstle_subscription_widget").concat(e," .appstle_subscription_wrapper {\n               border: 1.5px solid #cccccc;\n              // box-shadow: 0 0 0 1px #c4cdd5;\n              border-radius: 5px;\n              margin-bottom: 5px;\n              margin-top: 10px;\n              ").concat(getCssAsString(n.appstle_subscription_wrapper),"\n          }\n\n          #appstle_subscription_widget").concat(e," .appstle_subscription_wrapper_option {\n              display: flex;\n              position: relative;\n              padding: 16px 16px;\n          }\n          #appstle_subscription_widget").concat(e," .appstle_selected_background {\n            ").concat(getCssAsString(n.appstle_selected_background),"\n          }\n\n          #appstle_subscription_widget").concat(e," .appstle_subscription_wrapper_option:first-child {\n             // box-shadow: 0 1px 0 0 #c4cdd5;\n             border-bottom: inherit;\n          }\n            #appstle_subscription_widget").concat(e," .appstle_subscription_wrapper_option:first-child:last-child {\n             border-bottom: none;\n          }\n\n          #appstle_subscription_widget").concat(e," .appstle_subscription_wrapper_option:not(.appstle_include_dropdown) {\n            align-items: center;\n          }\n\n          #appstle_subscription_widget").concat(e," .appstle_subscription_wrapper_option.appstle_include_dropdown {\n            flex-direction: column;\n            justify-content: center;\n          }\n\n          .appstle_circle {\n            position: relative;\n          }\n\n          .appstle_subscription_wrapper_option input[type=radio]:focus + label .appstle_circle:before {\n            height: 24px;\n            width: 24px;\n            border: 2px solid #3a3a3a;\n            border-radius: 50%;\n            flex-shrink: 0;\n            content: '';\n            position: absolute;\n            left: 50%;\n            top: 50%;\n            transform: translate(-50%, -50%);\n        }\n\n        [name=\"selling_plan\"] {\n          position: absolute;\n          opacity: 0;\n      }\n      \n\n          #appstle_subscription_widget").concat(e," .appstle_subscribe_option {\n              margin-left: 29px;\n              margin-top: 25px;\n              display: flex;\n                  flex-direction: column;\n              align-items: flex-start;\n              text-align: left;\n          }\n\n          #appstle_subscription_widget").concat(e," .appstle_subscription_amount {\n              margin-left: auto;\n          }\n\n          #appstle_subscription_widget").concat(e," .appstle_circle {\n              display: flex;\n              height: 18px;\n              width: 18px;\n              border: 2px solid #3a3a3a;\n              border-radius: 50%;\n              margin-right: 10px;\n              justify-content: center;\n              align-items: center;\n              flex-shrink: 0;\n              ").concat(getCssAsString(n.appstle_circle),"\n            }\n\n          #appstle_subscription_widget").concat(e," .appstle_subscription_wrapper_option input[type=radio]:checked + label .appstle_circle .appstle_dot {\n              height: 10px;\n              width: 10px;\n              background-color: #3a3a3a;\n              border-radius: 50%;\n              flex-shrink: 0;\n              ").concat(getCssAsString(n.appstle_dot),"\n            }\n\n\n        #appstle_subscription_widget").concat(e," .appstle_radio_label {\n          display: flex !important;\n          align-items: center;\n          margin: 0;\n          padding: 0;\n          background: none;\n        }\n\n        #appstle_subscription_widget").concat(e," .appstle_select_label {\n          display: flex !important;\n          align-items: center;\n          margin: 0;\n          padding: 0;\n          background: none;\n          margin-bottom: 7px;\n          font-size: 12px;\n\n        }\n\n        #appstle_subscription_widget").concat(e," .appstle_form_field_input, #appstle_subscription_widget").concat(e," .appstle_form_field_text_input {\n          width: 100%;\n          padding-left: 20px;\n          padding-right: 20px;\n          height: 43px !important;\n          border-radius: 12px;\n          border: 1px solid #0000003d!important;\n          font-size: 1.5rem;\n          color: #495057;\n        }\n\n        #appstle_subscription_widget").concat(e," .appstle_tooltip {\n          -webkit-backface-visibility: hidden;\n          backface-visibility: hidden;\n          box-shadow: 0 2px 4px rgb(0 0 0 / 15%);\n          background-color: #3a3a3a;\n          border-radius: 5px;\n          left: 0;\n          color: #fff;\n          transition: transform .2s cubic-bezier(.215,.61,.355,1);\n          -ms-transform: translateY(0);\n          transform: translateY(100%) scaleY(0);\n          transform-origin: center top;\n          opacity: 0;\n          position: absolute;\n          bottom: 1px;\n          // border-bottom-left-radius: 0;\n          min-width: 250px;\n          ").concat(getCssAsString(n.appstle_tooltip),"\n        }\n\n\n\n        #appstle_subscription_widget").concat(e," [data-appstle-icon] {\n            -ms-flex-item-align: end;\n            backface-visibility: hidden;\n        }\n\n        #appstle_subscription_widget").concat(e," [data-appstle-icon]:after {\n              border: solid transparent;\n              border-top-color: #3a3a3a;\n              border-width: 9px;\n              content: '';\n              position: absolute;\n              pointer-events: none;\n              opacity: 0;\n              left: 2px;\n              bottom: 0;\n              -ms-transform: translateX(-50%) translateY(10px) rotate(180deg);\n              transform: translateY(10px) rotate(180deg);\n              transition-delay: 0;\n              visibility: hidden;\n              transition: transform .2s cubic-bezier(.215,.61,.355,1);\n              z-index: 99999999;\n              background: none;\n              padding: 0;\n              ").concat(getCssAsString(n.appstle_tooltip_border_top_color),"\n        }\n		@media screen and (max-width: 1024px) {\n\n			#appstle_subscription_widget").concat(e," [data-appstle-icon].appstle-tooltip-show .appstle_tooltip {\n				  opacity: 1;\n				  visibility: visible;\n				  transform: translateY(100%) scaleY(1);\n				  bottom: 1px;\n				  z-index: 99999999;\n			}\n\n			#appstle_subscription_widget").concat(e," [data-appstle-icon].appstle-tooltip-show:after {\n			  opacity: 1;\n			  visibility: visible;\n			  -ms-transform: translateX(-50%) translateY(0) rotate(180deg);\n			  transform: translateY(0) rotate(180deg);\n			}\n		}\n        @media screen and (min-width: 1025px) {\n			#appstle_subscription_widget").concat(e," [data-appstle-icon]:hover .appstle_tooltip {\n				  opacity: 1;\n				  visibility: visible;\n				  transform: translateY(100%) scaleY(1);\n				  bottom: 1px;\n				  z-index: 99999999;\n			}\n\n			#appstle_subscription_widget").concat(e," [data-appstle-icon]:hover:after {\n			  opacity: 1;\n			  visibility: visible;\n			  -ms-transform: translateX(-50%) translateY(0) rotate(180deg);\n			  transform: translateY(0) rotate(180deg);\n			}\n		}\n\n        #appstle_subscription_widget").concat(e," .appstle_tooltip_wrapper {\n          position: relative;\n          margin-bottom: 6px;\n          display: inline-flex;\n          align-items: center;\n          padding-top: 11px;\n          box-sizing: border-box;\n          margin-left: 0px;\n          padding-bottom: 11px;\n        }\n\n        #appstle_subscription_widget").concat(e," .appstle_tooltip_wrapper_static {\n          font-size: 13px;\n          background-color: beige;\n          border-radius: 6px;\n          padding: 23px;\n          margin-bottom: 10px;\n          ").concat(getCssAsString(n.appstle_tooltip),"\n        }\n\n        #appstle_subscription_widget").concat(e," .tooltip_subscription_svg {\n             height: 22px;\n            width: 22px;\n            margin-right: 10px;\n            fill: black;\n            ").concat(getCssAsString(n.tooltip_subscription_svg),"\n        }\n\n        #appstle_subscription_widget").concat(e," .appstle_subscription_radio_wrapper {\n            display: flex;\n            align-items: flex-start;\n        }\n\n        #appstle_subscription_widget").concat(e," .appstle_subscription_amount_wrapper {\n          margin-left: auto;\n          text-align: right;\n        }\n\n        #appstle_subscription_widget").concat(e," .appstle_subscription_amount_wrapper .appstle_prepaid_description {\n          font-size: 12px;\n          opacity: 0.8;\n        }\n\n        .appstle_subscription_final_price {\n            margin-right: 10px;\n            text-decoration: none;\n            color: #da4f49;\n            ").concat(getCssAsString(n.appstle_subscription_final_price),"\n        }\n\n        .appstle_subscription_save {\n            margin-left: 10px;\n              padding: 2px 6px;\n              border: 1px solid #da4f49;\n              border-radius: 3px;\n              font-size: 10px;\n              color: #da4f49;\n              font-weight: bold;\n              display: inline;\n              position: relative;\n              top: -3px;\n              letter-spacing: 1px;\n        }\n\n        #appstle_subscription_widget").concat(e," .appstle_subscription_wrapper .appstle_select {\n            width: 100%;\n            margin: 0;\n            ").concat(getCssAsString(n.appstle_select),"\n        }\n\n        #appstle_subscription_widget").concat(e," .appstle_hide_subsOption {\n          opacity: 0;\n          margin-top: 0;\n          visibility: hidden;\n          height: 0;\n        }\n\n        #appstle_subscription_widget").concat(e," .appstle_tooltip_content {\n          padding: 16px;\n        }\n\n        body #appstle_subscription_widget").concat(e," .appstle_tooltip_wrapper .appstle_tooltip .appstle_tooltip_appstle {\n          padding: 12px !important;\n          font-size: 8px !important;\n          letter-spacing: 2px !important;\n          text-align: right !important;\n          background: #13b5ea !important;\n          border-bottom-left-radius: 4px !important;\n          border-bottom-right-radius: 4px !important;\n          display: block !important;\n        }\n\n        .appstle_link {\n          color: inherit !important;\n          text-decoration: none !important;\n          cursor: pointer !important;\n        }\n\n        .appstleRadioSellingPlanWrapper {\n          display: flex;\n          flex-direction: column;\n        }\n        .appstleLoyaltyTable {\n          margin-top: 20px;\n        }\n\n        .appstle_loyalty_title {\n          margin-bottom: 10px;\n        }\n\n        .appstle-loyalty-billing-cycle-count, .appstle-loyalty-discount-amount, .appstle-loyalty-free-trial-discount {\n          color: #198946;\n          font-weight: bold;\n        }\n\n        .appstle_fields_wrapper {\n          margin-bottom: 20px;\n        }\n\n        .as-date-input-wrapper {\n          position: relative;\n        }\n\n        .as-date-input-wrapper .ui-datepicker-trigger {\n          position: absolute;\n          height: 100%;\n          width: 40px;\n          right: 0;\n          top: 0;\n        }\n\n        .as-date-input-wrapper .ui-datepicker-trigger img {\n          position: absolute;\n          top: 50%;\n          left: 50%;\n          width: 28px;\n          transform: translate(-50%, -50%);\n        }\n\n        .appstle_subscription_compare_amount  {\n          text-decoration: line-through;\n        }\n\n        #ui-datepicker-div {\n          z-index: 1000000 !important;\n        }\n\n\n\n\n        </style>\n        <style>").concat(n.customCSS,"</style>")).appendTo(jQuery("head"))}}function getBillingCycleText(e){var n=e%10,t=e%100;return n==1&&t!=11?e+"<sup>st</sup>":n==2&&t!=12?e+"<sup>nd</sup>":n==3&&t!=13?e+"<sup>rd</sup>":e+"<sup>th</sup>"}function renderStandAloneWidget(){var e=Array.prototype.slice.call(jQuery(".appstle_stand_alone_selector:not(.appstle_stand_alone_selector_processed)")),n=-1;(function t(){if(e!=null&&e.length){var i=e.shift(),a=$(i).data("product-data");n+=1,jQuery(i).parents("form").find(".appstle_sub_widget").length?t():a?(renderWidget(a,$(i),n),t()):fetch(location.origin+"/products/".concat(jQuery(i).data("product-handle"),".js")).then(function(l){if(!l.ok)throw new Error("HTTP error! Status: ".concat(l.status));return l.json()}).then(function(l){jQuery(i).attr("data-product-data",l),renderWidget(l,$(i),n),t()}).catch(function(l){console.error(l)})}})()}function urlIsProductPage(){return decodeURIComponent(window.location.pathname).includes("/products/")}function wrapPriceWithSpanTag(e){var n=document.createElement("textarea");return n.innerHTML=decodeURI(encodeURI(e)),n.value}function formatPrice(e){var n,t,i=RS.Config.moneyFormat,a=i;i&&(a=i==null||(t=i.replace("{% raw %}",""))===null||t===void 0?void 0:t.replace("{% endraw %}","")),typeof e=="string"&&(e=e.replace(".",""));var l,o="",r=/\{\{\s*(\w+)\s*\}\}/,s=typeof Shopify!="undefined"&&Shopify.money_format&&1<Shopify.money_format.length?Shopify.money_format:"";l=typeof theme!="undefined"?theme.moneyFormat?theme.moneyFormat:theme.money_format?theme.money_format:theme.settings&&theme.settings.moneyFormat?theme.settings.moneyFormat:theme.strings?theme.strings.moneyFormat:"":"";var c,p,b,d,C,u,_="";((n=RS.Config)===null||n===void 0?void 0:n.formatMoneyOverride)==="true"?_=RS.Config.moneyFormat:_=((c=window)===null||c===void 0?void 0:c.shopifyCurrencyFormat)||((p=window)===null||p===void 0?void 0:p.moneyFormat)||((b=window)===null||b===void 0||(d=b.Currency)===null||d===void 0?void 0:d.money_format_no_currency)||l||((C=RSConfig)===null||C===void 0?void 0:C.shopMoneyFormat)||a||s||(u=RSConfig.shopMoneyFormatWithCurrencyFormat,new DOMParser().parseFromString(u,"text/html").documentElement.textContent);function f(y,w,m,Q){if(m=m||",",Q=Q||".",isNaN(y)||y===null)return 0;var D=(y=(y/100).toFixed(w)).split(".");return D[0].replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1"+m)+(D[1]?Q+D[1]:"")}switch(_.match(r)[1]){case"amount":o=f(e,2);break;case"amount_no_decimals":o=f(e,0);break;case"amount_with_comma_separator":o=f(e,2,".",",");break;case"amount_no_decimals_with_comma_separator":o=f(e,0,".",",");break;case"amount_no_decimals_with_space_separator":o=f(e,0," ");break;case"amount_with_apostrophe_separator":o=f(e,2,"'")}return wrapPriceWithSpanTag(_.replace(r,o))}function displaySubscriptionPrice(){appstlePriceDisplaySelectorExists()&&(addFeaturePageCSS(),jQuery(".appstle_stand_alone_price_display_selector:not(.appstle_stand_alone_price_display_selector_processed)").each(function(e){var n,t,i,a,l=$(this).data("product-data"),o=Number.MAX_SAFE_INTEGER,r=!1;l==null||(n=l.variants)===null||n===void 0||n.forEach(function(s){var c;s==null||(c=s.selling_plan_allocations)===null||c===void 0||c.forEach(function(p){var b,d;(p==null||(b=p.price_adjustments[0])===null||b===void 0?void 0:b.price)<o&&(o=p==null||(d=p.price_adjustments[0])===null||d===void 0?void 0:d.price,r=!0)})}),r&&($(this).siblings(((t=RSConfig)===null||t===void 0?void 0:t.landingPagePriceSelector)||((i=RS)===null||i===void 0||(a=i.Config)===null||a===void 0?void 0:a.landingPagePriceSelector)||"span.price, span.appstle_hide_old_price, .price").hide(),$(this).html(wrapPriceWithSpanTag(buildSubscribeSaveSelector(o)))),$(this).show(),$(this).addClass("appstle_stand_alone_price_display_selector_processed")}))}console.log("jQuery is loaded, after "+tookTime+" milliseconds!"),RS.Config=Object.assign(RS.Config,typeof _RSConfig!="undefined"&&_RSConfig!==null?_RSConfig:{}),window.RSConfig=RS.Config,appstleStandAloneSelectorExists()?renderStandAloneWidget():renderWidget(void 0,void 0,0),jQuery(document).on("click","".concat((_window17=window)===null||_window17===void 0||(_window17$RS=_window17.RS)===null||_window17$RS===void 0||(_window17$RS$Config=_window17$RS.Config)===null||_window17$RS$Config===void 0?void 0:_window17$RS$Config.quickViewClickSelector)||"a.grid-product__link",function(){var e,n,t;if(0<jQuery("".concat((e=window)===null||e===void 0||(n=e.RS)===null||n===void 0||(t=n.Config)===null||t===void 0?void 0:t.quickViewClickSelector)||"a.grid-product__link").length){var i,a,l,o,r,s=function(){var c;appstleStandAloneSelectorExists()?renderStandAloneWidget():((c=jQuery("#appstle_subscription_widget0"))===null||c===void 0?void 0:c.length)==0&&renderWidget(void 0,void 0,0)};"".concat((i=window)===null||i===void 0||(a=i.RS)===null||a===void 0||(l=a.Config)===null||l===void 0?void 0:l.quickViewModalPollingSelector)||((o=window)===null||o===void 0||(r=o.Shopify)===null||r===void 0?void 0:r.shop)=="mahalia-coffee.myshopify.com"?function c(){var p,b,d;jQuery(".quickshop.quickshop-visible.quickshop-loaded").length||jQuery("".concat((p=window)===null||p===void 0||(b=p.RS)===null||b===void 0||(d=b.Config)===null||d===void 0?void 0:d.quickViewModalPollingSelector)).length?s():setTimeout(function(){c()},200)}():setTimeout(function(){s()},500)}}),setTimeout(displaySubscriptionPrice,30);var targetNode=document.querySelector("body"),config={attributes:!0,childList:!0,subtree:!0},observer=new MutationObserver(displaySubscriptionPrice);function addFeaturePageCSS(){var e,n=(e=RSConfig)===null||e===void 0?void 0:e.css;jQuery("<style>.appstle_subscribesavetext{\n                  background-color:#c00303;\n                  color:#fff;\n                  padding:4px 8px;\n                  font-size:13px;\n                }</style>\n                  <style>".concat(n==null?void 0:n.customCSS,"</style>")).appendTo(jQuery("head"))}function buildSubscribeSaveSelector(e){var n,t={subscriptionPrice:formatPrice(e)};return wrapPriceWithSpanTag(Mustache.render((n=RSConfig)===null||n===void 0?void 0:n.subscriptionPriceDisplayText,t))}function appstleStandAloneSelectorExists(){return 0<jQuery(".appstle_stand_alone_selector").length}function appstlePriceDisplaySelectorExists(){return 0<jQuery(".appstle_stand_alone_price_display_selector").length}function appstleSubscriptionCustomerPortalInit(e){var n;if(e=e||"#AppstleCustomerPortal",document.querySelector(e))return jQuery.get("/".concat((n=RSConfig)===null||n===void 0?void 0:n.manageSubscriptionUrl,"?renderType=html")).then(function(t){jQuery(e).html(t),document.dispatchEvent(new Event("AppstleSubscription:CustomerPortal:Embedded")),window.dispatchEvent(new Event("AppstleSubscription:CustomerPortal:Embedded"))}).catch(function(t){return console.error("error",t)})}function fetchAddJsSellingPlanInterCeptor(){var e,n=window.fetch;jQuery.ajaxSetup({beforeSend:function(t,i){if(console.log(t),console.log(i.data),console.log(i.url),(i==null?void 0:i.url)==="/cart/add.js"){var a=$(".appstle_sub_widget input[name=selling_plan]:checked").val();a&&(i.data=i.data+"&selling_plan=".concat(a))}}}),e=XMLHttpRequest.prototype.send,XMLHttpRequest.prototype.send=function(t){if(this._url.indexOf("/cart/add.js")!==-1){var i=null,a=$(".appstle_sub_widget input[name=selling_plan]:checked").val();if(a)try{t.substr(0,1)==="{"&&t.substr(-1)==="}"?((i=JSON.parse(t)).selling_plan=a,e.call(this,JSON.stringify(i))):t.substr(0,1)!=="{"&&t.substr(-1)!=="}"&&t.indexOf("&")!==-1?e.call(this,t+"&selling_plan=".concat(a)):e.call(this,t)}catch(l){e.call(this,t)}else e.call(this,t)}else e.call(this,t)},window.fetch=function(){var t=arguments[0],i=arguments[1];if(t.indexOf("/cart/add")===-1)return n.apply(this,arguments);var a=new URLSearchParams(window.location.search).get("variant");if(getClassOf(i.body)!=="FormData"&&getClassOf(i.body)!=="Object"){if(!isJsonString(i==null?void 0:i.body)){var l=$(".appstle_sub_widget input[name=selling_plan]:checked").val();return l&&(i.body=i.body+"&selling_plan="+l),n.apply(this,arguments)}var o={},r=JSON.parse(i==null?void 0:i.body);if(getClassOf(r)==="Object"&&getClassOf(r==null?void 0:r.items)=="Array"){var s,c=r==null||(s=r.items)===null||s===void 0?void 0:s.findIndex(function(u){return u.id==a});if(0<=c){var p,b=r==null||(p=r.items)===null||p===void 0?void 0:p.filter(function(u){return u.id!=a}),d=JSON.parse(JSON.stringify(r==null?void 0:r.items[c]));return d.selling_plan=$(".appstle_sub_widget input[name=selling_plan]:checked").val(),b.push(d),o.items=JSON.parse(JSON.stringify(b)),i.body=JSON.stringify(o),n.apply(this,arguments)}return n.apply(this,arguments)}if(getClassOf(r)==="Object"){var C=JSON.parse(i==null?void 0:i.body);return C.selling_plan=$(".appstle_sub_widget input[name=selling_plan]:checked").val(),i.body=JSON.stringify(C),n.apply(this,arguments)}}else if(getClassOf(i.body)==="FormData")return i.body.set("selling_plan",$(".appstle_sub_widget input[name=selling_plan]:checked").val()||""),n.apply(this,arguments)}}function isJsonString(e){try{JSON.parse(e)}catch(n){return!1}return!0}function getClassOf(e){return Object.prototype.toString.call(e).slice(8,-1)}function dispatchAppstleEvent(e){document.dispatchEvent(new Event("AppstleSubscription:SubscriptionWidget:".concat(e))),window.dispatchEvent(new Event("AppstleSubscription:SubscriptionWidget:".concat(e)))}function urlParamsToObject(e){for(var n,t=(e==null||(n=e.substr(1))===null||n===void 0?void 0:n.split("&"))||location.search.substr(1).split("&"),i={},a=0;a<t.length;a++){var l=t[a].split("=");i[l[0]]=l[1]}return i}function urlParam(e,n){return urlParamsToObject(n)[e]||null}function attachMutationObserver(e,n){var t=document.querySelector(e),i={attributes:!0,childList:!0,subtree:!0},a=new MutationObserver(n);t&&i&&a.observe(t,i)}function detectSwapAction(){urlParam("action")=="swap"&&(attatchHandlerToSwapButtons(),addSwapButton(),attachMutationObserver("main",function(){return addSwapButton()}),jQuery("<style>.appstle-swap-product .appstle-swap-product-loader, .appstle-swap-product .appstle-swap-product-success, .appstle-swap-product .appstle-swap-product-error,\n              .appstle-swap-product.inProgress .appstle-swap-product-text, .appstle-swap-product.inProgress .appstle-swap-product-success, .appstle-swap-product.inProgress .appstle-swap-product-error,\n              .appstle-swap-product.success .appstle-swap-product-text, .appstle-swap-product.success .appstle-swap-product-loader, .appstle-swap-product.success .appstle-swap-product-error ,\n              .appstle-swap-product.error .appstle-swap-product-text, .appstle-swap-product.error .appstle-swap-product-success, .appstle-swap-product.error .appstle-swap-product-loader {\n                display: none;\n              }\n\n              .appstle-swap-product .appstle-swap-product-text,\n              .appstle-swap-product.inProgress .appstle-swap-product-loader,\n              .appstle-swap-product.success .appstle-swap-product-success,\n              .appstle-swap-product.error .appstle-swap-product-error {\n                display: block;\n              }</style>").appendTo("head"))}function addSwapButton(e){$(e||".product-block:not(.sold-out) ").each(function(n,t){$(t).find(".appstle-swap-product").length||$(t).append('<button class="appstle-swap-product"><span class="appstle-swap-product-text">SWAP</span><span class="appstle-swap-product-loader">Swapping</span><span class="appstle-swap-product-success">Swapped</span><span class="appstle-swap-product-error">Error</span></button>')})}function attatchHandlerToSwapButtons(){$(document).on("click",".appstle-swap-product",function(){var e=$(this);e.addClass("inProgress");var n=getTargetVariantId(this),t=urlParam("lineId"),i=urlParam("contractId"),a="/apps/subscriptions/cp/api/subscription-contract-details/replace-variants-v2?contractId=".concat(i,"&newVariantId=").concat(n,"&quantity=","1","&oldLineId=").concat(t);fetch(a,{method:"POST"}).then(function(l){e.removeClass("inProgress"),l.ok?(e.addClass("success"),location.href="/account"):e.addClass("error"),setTimeout(function(){return resetButton(e)},2500)}).catch(function(l){e.removeClass("inProgress"),e.addClass("error"),setTimeout(function(){return resetButton(e)},2500)})})}function resetButton(e){e.removeClass("inProgress"),e.removeClass("success"),e.removeClass("error")}function getTargetVariantId(e){var n=$(e),t=null;if(!t){var i=n.parent().find("a").attr("href"),a=new URL(location.origin+i);t=urlParam("variant",a==null?void 0:a.search)}return t}observer.observe(targetNode,config),window.appstleSubscriptionCustomerPortalInit=appstleSubscriptionCustomerPortalInit,appstleSubscriptionCustomerPortalInit(),document.dispatchEvent(new Event("AppstleSubscription:CustomerPortal:ReadyToEmbed")),window.dispatchEvent(new Event("AppstleSubscription:CustomerPortal:ReadyToEmbed")),((_jQuery2=jQuery(".appstle_stand_alone_selector"))===null||_jQuery2===void 0?void 0:_jQuery2.length)!==1&&urlIsProductPage()!==!0||((_window26=window)===null||_window26===void 0||(_window26$RS=_window26.RS)===null||_window26$RS===void 0||(_window26$RS$Config=_window26$RS.Config)===null||_window26$RS$Config===void 0?void 0:_window26$RS$Config.enableAddJSInterceptor)!=="true"||fetchAddJsSellingPlanInterCeptor(),detectSwapAction(),((_window27=window)===null||_window27===void 0||(_window27$RS=_window27.RS)===null||_window27$RS===void 0||(_window27$RS$Config=_window27$RS.Config)===null||_window27$RS$Config===void 0?void 0:_window27$RS$Config.enableCartWidgetFeature)==="true"&&function(){var e,n,t,i,a,l,o,r,s,c,p,b,d,C,u,_,f,y,w,m,Q,D,M,q=(e=window)===null||e===void 0||(n=e.RS)===null||n===void 0||(t=n.Config)===null||t===void 0?void 0:t.selectors.cartRowSelector,H=(i=window)===null||i===void 0||(a=i.RS)===null||a===void 0||(l=a.Config)===null||l===void 0?void 0:l.selectors.cartLineItemSelector,U="[data-appstle-selector]",K=(o=window)===null||o===void 0||(r=o.RS)===null||r===void 0||(s=r.Config)===null||s===void 0?void 0:s.selectors.cartLineItemPerQuantityPriceSelector,z=(c=window)===null||c===void 0||(p=c.RS)===null||p===void 0||(b=p.Config)===null||b===void 0?void 0:b.selectors.cartLineItemTotalPriceSelector,se=(d=window)===null||d===void 0||(C=d.RS)===null||C===void 0||(u=C.Config)===null||u===void 0?void 0:u.selectors.cartLineItemSellingPlanNameSelector,fe=(_=window)===null||_===void 0||(f=_.RS)===null||f===void 0||(y=f.Config)===null||y===void 0?void 0:y.selectors.cartSubTotalSelector,re=(w=window)===null||w===void 0||(m=w.RS)===null||m===void 0||(Q=m.Config)===null||Q===void 0?void 0:Q.selectors.cartLineItemPriceSelector,Y=JSON.parse(RS.Config.labels),he="";function Pe(){jQuery("#appstle_overlay").length||Ce(),jQuery(".appstle_subscription_cart_wrapper select").each(function(g,S){jQuery(S).off()}),jQuery(".appstle_subscribe_selected input").each(function(g,S){jQuery(S).off()}),jQuery(".appstle_subscribe_title").each(function(g,S){jQuery(S).off()}),jQuery(".appstle_selected_frequency").each(function(g,S){jQuery(S).off()}),fetch("/cart.js").then(function(g){return g.json()}).then(function(g){var S,T,O,x,W,v,F=[],P=[];function ve(){g.items.forEach(function(h,X){var G,ne,te,pe,Z,J=P.filter(function(R){return R.handle===h.handle}).pop(),ye=(te=JSON.parse(JSON.stringify(J)),pe=h==null?void 0:h.variant_id,!!((Z=(te==null?void 0:te.variants.filter(function(R){return R.id===pe})).pop())&&Z!=null&&Z.selling_plan_allocations&&Z!=null&&Z.selling_plan_allocations.length)),ee=h==null||(G=h.selling_plan_allocation)===null||G===void 0||(ne=G.selling_plan)===null||ne===void 0?void 0:ne.id;if(ye){var N=jQuery('<div class="appstle_subscription_cart_wrapper">\n                        <div class="appstle_subscribe_title">\n                            <input type="checkbox"></input>\n                            <span class="appstle_discount_text"><span class="appstle_highest_discount">'.concat(Y["appstle.subscription.wg.subscribeAndSaveInitalV2"],'</span></span>\n                        </div>\n                        <div class="appstle_subscribe_selected_wrapper" style="display: none;">\n                            <div class="appstle_subscribe_selected">\n                              <input type="checkbox" checked ').concat(J!=null&&J.requires_selling_plan?"disabled":"",'></input>\n                              <div class="appstle_subscribe_selected_text">').concat(Y["appstle.subscription.wg.subscribeAndSaveSuccessV2"],'</div>\n                            </div>\n                            <div class="appstle_selected_frequency">\n                                <span class="appstle_deliveryText">{{deliveryText}}</span>&nbsp;\n                                <span class="appstle_applied_sellingPlanName">{{appliedSellingPlanName}}</span>\n                                <p class="appstle_applied_discountText"></p>\n                            </div>\n                        </div>\n                        <div class="appstle_radio_section" style="display: none">\n\n                            <select id="appstle_selling_plan_cart" data-product-select-id="').concat(JSON.parse(JSON.stringify(J)).id,"-").concat(ee,'" class="appstle_select_cart"></select>\n                        </div>\n                    </div>'));(function(R,j,ce,be){var de,ke,Re,je,Ie,Qe,we,De,ue=[];if(jQuery.each(R.selling_plan_groups,function(A,E){E.app_id==="appstle"&&jQuery.each(E.selling_plans,function(I,V){if(function(L){var Fe=__st.cid,Ve=RSConfig.customer_tags||[],ge=!0;if(!Fe&&RSConfig.memberOnlySellingPlansJson&&RSConfig.memberOnlySellingPlansJson[L]&&RSConfig.memberOnlySellingPlansJson[L].enableMemberInclusiveTag&&(ge=!1),Fe&&RSConfig.nonMemberOnlySellingPlansJson&&RSConfig.nonMemberOnlySellingPlansJson[L]&&(ge=!1),ge&&Fe&&RSConfig.memberOnlySellingPlansJson&&RSConfig.memberOnlySellingPlansJson[L]){if(RSConfig.memberOnlySellingPlansJson[L].memberInclusiveTags&&RSConfig.memberOnlySellingPlansJson[L].memberInclusiveTags.trim()){var He=RSConfig.memberOnlySellingPlansJson[L].memberInclusiveTags.split(","),Ge=qe(Ve,He);ge=0<Ge.length}if(RSConfig.memberOnlySellingPlansJson[L].memberExclusiveTags&&RSConfig.memberOnlySellingPlansJson[L].memberExclusiveTags.trim()){var Ue=RSConfig.memberOnlySellingPlansJson[L].memberExclusiveTags.split(","),ze=qe(Ve,Ue);ge=!(0<ze.length)}}return ge}(V.id)){var B=be.selling_plan_allocations.find(function(L){return L.selling_plan_id===V.id});if(!B)return;var ae=B.per_delivery_price,Se=formatPrice(B==null?void 0:B.price),oe=formatPrice(ae),Oe=null,$e=null;$e=B&&B.price_adjustments&&B.price_adjustments.length===2?formatPrice(Oe=B.price_adjustments[1].price):(Oe=ae,oe);var xe=V.price_adjustments.shift();ue.push({name:V.name,id:V.id,formattedPrice:oe,price:ae,totalPrice:Se,secondPrice:Oe,secondFormattedPrice:$e,discount:xe?xe.value_type==="percentage"?"".concat(xe.value,"%"):formatPrice(xe.value):"",deliveryText:V.options[0].name})}})}),0<ue.length){ue.sort(function(A,E){return A.price-E.price}),jQuery("<option />",{html:Y["appstle.subscription.wg.selectDeliverOptionV2"]||"Select Delivery Option",value:""}).appendTo(j.find("select")),jQuery(ue).each(function(A,E){var I,V,B=(V=(I=E).totalPrice==I.formattedPrice?{sellingPlanName:I.name,sellingPlanPrice:'<span class="transcy-money">'.concat(I.formattedPrice,"</span>"),secondSellingPlanPrice:'<span class="transcy-money">'.concat(I.secondFormattedPrice,"</span>")}:{sellingPlanName:I.name,totalPrice:'<span class="transcy-money">'.concat(I==null?void 0:I.totalPrice,"</span>"),sellingPlanPrice:'<span class="transcy-money">'.concat(I.formattedPrice,"</span>"),secondSellingPlanPrice:'<span class="transcy-money">'.concat(I.secondFormattedPrice,"</span>")},wrapPriceWithSpanTag(Mustache.render(RS.Config.sellingPlanTitleText,V)));jQuery("<option />",{value:E.id,html:B,selected:ce===(E==null?void 0:E.id)}).appendTo(j.find("select"))}),R!=null&&R.requires_selling_plan||jQuery("<option />",{value:"appstle_unsubscribe",html:Y["appstle.subscription.wg.unsubscribeFrequencyTextV2"]||"Unsubscribe"}).appendTo(j.find("select"));var Te=ue.filter(function(A){return(A==null?void 0:A.id)===ce}).pop();if(Te){var Ne=j.find(".appstle_selected_frequency .appstle_deliveryText").text().split("{{deliveryText}}").join(Y["appstle.subscription.wg.deliveryEveryFrequencyTextV2"]||"");j.find(".appstle_deliveryText").html(Ne);var Je=j.find(".appstle_selected_frequency .appstle_applied_sellingPlanName").text().split("{{appliedSellingPlanName}}").join(Te.name);j.find(".appstle_applied_sellingPlanName").html(Je);var Le=j.find(".appstle_subscribe_selected_text").text().split("{{{discountValue}}}").join(Te.discount);j.find(".appstle_subscribe_selected_text").html(Le),de=Te.id,ke=j,we=(Re=RSConfig)===null||Re===void 0||(je=Re.sellingPlansJson)===null||je===void 0?void 0:je.find(function(A){return(A==null?void 0:A.id.split("/").pop())===String(de)}),De=[],we!=null&&(Ie=we.appstleCycles)!==null&&Ie!==void 0&&Ie.length&&(we==null||(Qe=we.appstleCycles)===null||Qe===void 0||Qe.forEach(function(A){De.push(A==null?void 0:A.freeProductHandle)})),function A(E,I,V){var B,ae,Se=E.shift();return(B=window)!==null&&B!==void 0&&(ae=B.products)!==null&&ae!==void 0&&ae[Se]?E.length?A(E,I,V):Ae(I,V):fetch("/products/".concat(Se,".js")).then(function(oe){if(oe.ok)return oe.json()}).then(function(oe){return window.products||(window.products={}),window.products[Se]=oe,E.length?A(E,I,V):Ae(I,V)})}(De,de,ke)}else{var Me=j.find(".appstle_highest_discount").text().split("{{{discountValue}}}").join(ue[0].discount);j.find(".appstle_highest_discount").html(Me)}}})(JSON.parse(JSON.stringify(J)),N,ee,JSON.parse(JSON.stringify(J.variants.filter(function(R){return R.id===h.id}).pop()))),jQuery(N).find("select").on("change",function(R){Ee(g==null?void 0:g.items,h,J.id,R.target.value,!1)}),jQuery(N).find(".appstle_subscribe_selected input").on("change",function(R){Ee(g==null?void 0:g.items,h,J.id,jQuery(N).find("select").val(),!0)}),jQuery(N).find(".appstle_subscribe_title, .appstle_selected_frequency").on("click",function(){$(this).hide(),$(this).parents(".appstle_subscription_cart_wrapper").find(".appstle_radio_section").show()});var ie,le,k=jQuery(jQuery(q)[X]);if(ee&&(N.find(".appstle_subscribe_title").hide(),N.find(".appstle_subscribe_selected_wrapper").show(),k.find(se).text(h==null||(ie=h.selling_plan_allocation)===null||ie===void 0||(le=ie.selling_plan)===null||le===void 0?void 0:le.name)),k.find(se).hide(),k.find(".appstle_subscription_cart_wrapper").remove(),k.find(H).length===1?N.insertBefore(k.find(H)):N.insertBefore(k.find(U)),k.find(K).html(formatPrice(h.final_price)),k.find(z).html(formatPrice(h.final_line_price)),ee&&h.selling_plan_allocation.compare_at_price){k.find(re).html("");var me='<span class="appstle_cart_sellingPlan_price">'.concat(formatPrice(h.final_price),'</span><span  class="appstle_cart_compare_price">').concat(formatPrice(h.selling_plan_allocation.compare_at_price),"</span>");k.find(re).html(me)}}jQuery(jQuery(q)[X]).find(H).addClass("appstleCartWidgetProcessed")}),jQuery(fe).html(formatPrice(g==null?void 0:g.total_price)),jQuery("#appstle_overlay").remove()}0<(g==null||(S=g.items)===null||S===void 0?void 0:S.length)?((g==null||(T=g.items)===null||T===void 0?void 0:T.length)===jQuery(q).length?g==null||g.items.forEach(function(h){F.indexOf(h==null?void 0:h.handle)===-1&&F.push(h==null?void 0:h.handle)}):(O=window)!==null&&O!==void 0&&(x=O.RS)!==null&&x!==void 0&&(W=x.Config)!==null&&W!==void 0&&(v=W.selectors)!==null&&v!==void 0&&v.cartRowSelector&&q!=null&&q.length&&jQuery(q).length&&location.reload(),function h(){if(F.length){var X=F.shift();X?fetch("/products/".concat(X,".js")).then(function(G){return G.json()}).then(function(G){P.push(G),h()}):h()}else ve(),document.dispatchEvent(new Event("AppstleSubscription:CartWidget:Updated")),window.dispatchEvent(new Event("AppstleSubscription:CartWidget:Updated"))}()):jQuery("#appstle_overlay").remove()})}if(location.pathname==="/cart"){var Be=window.XMLHttpRequest.prototype.open;window.XMLHttpRequest.prototype.open=function(){this.addEventListener("load",function(){var g=this.responseURL;console.log("origOpe.n -> url="+g),g.indexOf("cart/change.js")!==-1&&he!==JSON.stringify(this.response)&&(jQuery("#appstle_overlay").length||Ce(),setTimeout(Pe,100),he=JSON.stringify(this.response))}),Be.apply(this,arguments)};var We=window.fetch;window.fetch=function(){var g=arguments,S=this;return new Promise(function(T,O){We.apply(S,g).then(function(x){x.url.indexOf("cart/change.js")!==-1&&(jQuery("#appstle_overlay").length||Ce(),setTimeout(Pe,100)),T(x)}).catch(function(x){console.error(x)})})},Pe(),M=(D=RSConfig)===null||D===void 0?void 0:D.css,jQuery("<style>\n                 .appstle-subsccribe-cart-discount{\n                       margin-left: 2px;\n                 }\n\n                .appstle_cart_radio_selected .appstle_cart_selling_plan_dropdown{\n                    display: block;\n                }\n            .appstle_cart_radio_selected {\n                  background-color: #eee;\n                 border-radius: 6px;\n            }\n            .appstle-cart-radio-label{\n              margin-left: 10px;\n            }\n            .appstle_subscription_cart_wrapper{\n              max-width: 100%;\n              justify-content: flex-start;\n              flex-direction: column;\n              font-size: 13px;\n            }\n              .appstle_cart_radio_label {\n                margin-left: 10px;\n                font-weight: bold;\n              }\n\n              .appstle_radio_section{\n              }\n              .appstle_subscribe_title {\n                      cursor: pointer;\n                      font-size: 13px;\n                      display: flex;\n                      align-items: center;\n                      line-height: 1.5;\n                      margin-bottom: 0.2rem;\n\n              }\n              .appstle_subscribe_title .appstle_highest_discount, .appstle_applied_sellingPlanName {\n                      border-bottom: 1px solid currentColor;\n              }\n\n              .appstle_subscribe_title input {\n                      margin-right: 5px;\n              }\n\n              .appstle_subscribe_selected {\n                      display: flex;\n                      align-items: center;\n                      margin-bottom: 0.2rem;\n\n              }\n\n              .appstle_subscribe_selected input {\n                      margin-right: 5px;\n              }\n\n              .appstle_selected_frequency  {\n                     display: inline;\n                     margin-bottom: 0.2rem;\n                     cursor: pointer;\n              }\n\n              .appstle_selected_frequency .appstle_applied_sellingPlanName {\n                       border-bottom: 1px solid currentColor;\n              }\n\n              .appstle_highest_discount, .appstle_applied_sellingPlanName {\n                      color: #198946;\n              }\n\n              #appstle_overlay {\n  width: 100%;\n  height: 100%;\n  position: fixed;\n  top: 0;\n  left: 0;\n  background: rgba(0, 0, 0, 0.7);\n  z-index: 999999;\n  text-align: center;\n }\n\n.appstle_loader {\n  border: 6px solid rgba(255, 255, 255, 0.2);\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  margin-top: -36px;\n  margin-left: -36px;\n  border-top: 6px solid #fff;\n  border-radius: 50%;\n  width: 60px;\n  height: 60px;\n  animation: appstle_loading_spin 0.7s linear infinite; }\n\n  .appstle_loader_text {\n    position: absolute;\n    left: 50%;\n    top: calc(50% + 60px);\n    transform: translate(-50%, -50%);\n    color: white;\n  }\n\n  .appstle_subscribe_selected input[type=checkbox] {\n      height: inherit;\n  }\n\n  .appstle_cart_compare_price {\n    text-decoration: line-through;\n    font-size: 13px;\n    margin-left: 5px;\n    opacity: 0.85;\n  }\n  .appstle-loyalty-billing-cycle-count, .appstle-loyalty-discount-amount, .appstle-loyalty-free-trial-discount {\n    color: #198946;\n    font-weight: bold;\n  }\n\n\n@keyframes appstle_loading_spin {\n  0% {\n    transform: rotate(0deg); }\n\n  100% {\n    transform: rotate(360deg); } }\n\n@-webkit-keyframes spin {\n  0% {\n    transform: rotate(0deg); }\n\n  100% {\n    transform: rotate(360deg); } }\n\n              </style>\n          <style>".concat(M==null?void 0:M.customCSS,"</style>")).appendTo(jQuery("head"))}function Ce(g){jQuery("#appstle_overlay").length||jQuery("body").append("<div id='appstle_overlay'><div class='appstle_loader'></div><div class='appstle_loader_text'>"+(g||" ")+"</div></div></div>")}function _e(g,S,T,O,x,W,v,F){if(JSON.parse(RS.Config.labels)["appstle.subscription.wg.loyaltyPerkDescriptionTextV2"]){var P={discount:S,discountType:T,formatDiscountedPrice:formatPrice(100*S),freeProductName:W,isDiscountTypePercentage:T==="PERCENTAGE",isDiscountTypeShipping:T==="SHIPPING",isDiscountTypeFreeProduct:T==="FREE_PRODUCT",isFreeTrial:O,isCartPage:!0,featured_image:v,productPrice:F,billingCycleBlock:'<span class="appstle-loyalty-billing-cycle"><span class="appstle-loyalty-billing-cycle-count">'.concat(g,"</span>")};return Mustache.render(JSON.parse(RS.Config.labels)["appstle.subscription.wg.loyaltyPerkDescriptionTextV2"],P)}return O?'Get <span class="appstle-loyalty-free-trial-discount">'.concat(S,' <span class="appstle-loyalty-free-trial-discount-count" style="text-transform: lowercase;">').concat(T).concat(1<S?"s":"",'</span></span> <span class="appstle-loyalty-free-trial-text">free trial.</span>'):T==="PERCENTAGE"?x?'<span class="appstle-loyalty-discount">Get <span class="appstle-loyalty-discount-amount">'.concat(S+"% off",'</span></span><span class="appstle-loyalty-billing-cycle"> after <span class="appstle-loyalty-billing-cycle-count">').concat(g,"</span> recurring order</span>."):'Thereafter <span class="appstle-loyalty-billing-cycle"><span class="appstle-loyalty-billing-cycle-count">'.concat(g,'</span> recurring order</span>, <span class="appstle-loyalty-discount">get <span class="appstle-loyalty-discount-amount">').concat(S+"% off","</span></span>."):T==="SHIPPING"?x?'<span class="appstle-loyalty-discount">Get <span class="appstle-loyalty-discount-amount">'.concat("shipping at ".concat(formatPrice(100*S)),'</span></span><span class="appstle-loyalty-billing-cycle"> after <span class="appstle-loyalty-billing-cycle-count">',g,"</span> recurring order</span>."):'Thereafter <span class="appstle-loyalty-billing-cycle"><span class="appstle-loyalty-billing-cycle-count">'.concat(g,'</span> recurring order</span>, <span class="appstle-loyalty-discount">get <span class="appstle-loyalty-discount-amount">',"shipping at ".concat(formatPrice(100*S)),"</span></span>."):T==="FREE_PRODUCT"?x?'<span class="appstle-loyalty-discount">Get a<span class="appstle-loyalty-discount-amount"> FREE PRODUCT ('.concat(W,')</span></span><span class="appstle-loyalty-billing-cycle"> after <span class="appstle-loyalty-billing-cycle-count">').concat(g,"</span> recurring order</span>."):'Thereafter <span class="appstle-loyalty-billing-cycle"><span class="appstle-loyalty-billing-cycle-count">'.concat(g,'</span> recurring order</span>, <span class="appstle-loyalty-discount">get <span class="appstle-loyalty-discount-amount">FREE PRODUCT (').concat(W,")</span></span>."):T==="FIXED"?x?'<span class="appstle-loyalty-discount">Get <span class="appstle-loyalty-discount-amount">'.concat(formatPrice(100*S)+" off",'</span></span><span class="appstle-loyalty-billing-cycle"> after <span class="appstle-loyalty-billing-cycle-count">').concat(g,"</span> recurring order</span>."):'Thereafter <span class="appstle-loyalty-billing-cycle"><span class="appstle-loyalty-billing-cycle-count">'.concat(g,'</span> recurring order</span>, <span class="appstle-loyalty-discount">get <span class="appstle-loyalty-discount-amount">').concat(formatPrice(100*S)+" off","</span></span>."):void 0}function Ae(g,S){var T,O,x,W,v=(T=RSConfig)===null||T===void 0||(O=T.sellingPlansJson)===null||O===void 0?void 0:O.find(function(P){return(P==null?void 0:P.id.split("/").pop())===String(g)}),F="";v!=null&&v.freeTrialEnabled&&(F=_e(0,v.freeTrialCount,v.freeTrialInterval,v==null?void 0:v.freeTrialEnabled,!0)),v!=null&&v.afterCycle2&&(F=F+"".concat(v!=null&&v.freeTrialEnabled?" ":"")+_e(getBillingCycleText(v.afterCycle2),v.discountOffer2,v.discountType2,!1,!(v!=null&&v.freeTrialEnabled))),v==null||(x=v.appstleCycles)===null||x===void 0||!x.length||v!=null&&v.freeTrialEnabled||v==null||(W=v.appstleCycles)===null||W===void 0||W.forEach(function(P,ve){var h="",X="",G="";if((P==null?void 0:P.discountType)==="FREE_PRODUCT"){var ne,te,pe,Z,J,ye,ee,N,ie,le,k,me,R,j,ce,be;h=(ne=window)===null||ne===void 0||(te=ne.products)===null||te===void 0||(pe=te[P.freeProductHandle])===null||pe===void 0?void 0:pe.title,1<((Z=window)===null||Z===void 0||(J=Z.products)===null||J===void 0||(ye=J[P==null?void 0:P.freeProductHandle])===null||ye===void 0?void 0:ye.variants.length)&&(h=h+" - "+((be=((R=window)===null||R===void 0||(j=R.products)===null||j===void 0||(ce=j[P==null?void 0:P.freeProductHandle])===null||ce===void 0?void 0:ce.variants.filter(function(de){return(de==null?void 0:de.id)===parseInt(P==null?void 0:P.freeVariantId)})).pop())===null||be===void 0?void 0:be.title)),X=(ee=window)===null||ee===void 0||(N=ee.products)===null||N===void 0||(ie=N[P.freeProductHandle])===null||ie===void 0?void 0:ie.featured_image,G=formatPrice((le=window)===null||le===void 0||(k=le.products)===null||k===void 0||(me=k[P.freeProductHandle])===null||me===void 0?void 0:me.price)}v!=null&&v.afterCycle2&&ve<1?F=F+" "+_e(getBillingCycleText(P.afterCycle),P.value,P.discountType,!1,!1,h):v!=null&&v.afterCycle2||ve<2&&(F=ve==0?_e(getBillingCycleText(P.afterCycle),P.value,P.discountType,!1,!0,h,X,G):F+" "+_e(getBillingCycleText(P.afterCycle),P.value,P.discountType,!1,!1,h,X,G))}),S.find(".appstle_applied_discountText").html(F)}function Ee(g,S,T,O,x){if(O){O==="appstle_unsubscribe"&&(x=!0),Ce();var W={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:S==null?void 0:S.key,quantity:(S==null?void 0:S.quantity)||1,selling_plan:x?"":O})};fetch("/cart/change.js",W).then(function(v){return v.json()}).then(function(v){setTimeout(function(){Pe()},200)}).catch(function(v){return console.error(v)})}}function qe(g,S){return g.filter(function(T){return S.indexOf(T)!=-1})}}()})()}),Shopify&&Shopify.checkout&&1<=Shopify.checkout.line_items.filter(function(e){return e.selling_plan_id}).length&&(_RS4=RS)!==null&&_RS4!==void 0&&(_RS4$Config=_RS4.Config)!==null&&_RS4$Config!==void 0&&_RS4$Config.showCheckoutSubscriptionBtn){var destination="/"+RS.Config.manageSubscriptionUrl,message=RS.Config.orderStatusManageSubscriptionDescription||"Continue to your account to view and manage your subscriptions.";Shopify.checkout&&Shopify.checkout.order_id?(console.log("orderId="+Shopify.checkout.order_id),fetch(location.origin+"/apps/subscriptions?action=customer_payment_token&order_id="+Shopify.checkout.order_id).then(function(e){return e.json()}).then(function(e){destination=destination+"?token="+e.token,Shopify.Checkout.OrderStatus.addContentBox('<h2 class="heading-2 os-step__title">'+(RS.Config.orderStatusManageSubscriptionTitle||"Subscription")+'</h2><div class="os-step__info--item"><p class="os-step__description" style="margin-top: 0.5714285714em;">'+message+'</p></div><a class="ui-button btn btn--subdued btn--size-small shown-if-js os-step__info" href="'+destination+'"> '+(RS.Config.orderStatusManageSubscriptionButtonText||"Manage your subscription")+"</a>")})):Shopify.Checkout.OrderStatus.addContentBox('<h2 class="heading-2 os-step__title">'+(RS.Config.orderStatusManageSubscriptionTitle||"Subscription")+'</h2><div class="os-step__info--item"><p class="os-step__description" style="margin-top: 0.5714285714em;">'+message+'</p></div><a class="ui-button btn btn--subdued btn--size-small shown-if-js os-step__info" href="'+destination+'"> '+(RS.Config.orderStatusManageSubscriptionButtonText||"Manage your subscription")+"</a>")}};appstleInit();
//# sourceMappingURL=/s/files/1/0732/5204/5084/t/23/assets/appstle-subscription.js.map?v=1680241068
